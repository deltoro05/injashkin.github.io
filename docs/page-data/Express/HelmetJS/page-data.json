{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/Express/HelmetJS/",
    "result": {"data":{"site":{"siteMetadata":{"title":"jinv.ru"}},"markdownRemark":{"id":"fa500c48-4c6a-5a64-842a-179d03359313","excerpt":"Для написания статьи использованы источники: helmetjs и freecodecamp. Установка и подключение Helmet Helmet поможет вам защитить ваши Express приложения…","html":"<p>Для написания статьи использованы источники: <a href=\"https://helmetjs.github.io/docs\">helmetjs</a> и <a href=\"https://www.freecodecamp.org/learn/information-security-and-quality-assurance/information-security-with-helmetjs/\">freecodecamp</a>.</p>\n<h2>Установка и подключение Helmet</h2>\n<p>Helmet поможет вам защитить ваши Express приложения, установив различные HTTP заголовки.</p>\n<p>Установите пакет Helmet:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ npm install helmet</code></pre></div>\n<p>Затем используйте его в своем коде:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">var</span> helmet <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'helmet'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span><span class=\"token function\">helmet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2><code class=\"language-text\">helmet.hidePoweredBy()</code> скрывает потенциально опасную информацию</h2>\n<p>Хакеры могут использовать известные уязвимости в Express/Node, если они видят, что ваш сайт работает на Express. На каждый клиентский запрос Express отправляет ответ, в котором, по умолчанию, присутствует HTTP заголовок <code class=\"language-text\">X-Powered-By: Express</code>. Промежуточный обработчик <code class=\"language-text\">helmet.hidePoweredBy()</code> удаляет заголовок X-Powered-By.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">var</span> helmet <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'helmet'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>helmet<span class=\"token punctuation\">.</span><span class=\"token function\">hidePoweredBy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Вы также можете явно установить заголовок на что-то другое, чтобы сбить людей с толку, например,</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">var</span> helmet <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'helmet'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>helmet<span class=\"token punctuation\">.</span><span class=\"token function\">hidePoweredBy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">setTo</span><span class=\"token operator\">:</span> <span class=\"token string\">'PHP 4.2.0'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2><code class=\"language-text\">helmet.frameguard()</code> уменьшает риск взлома</h2>\n<p>Ваша страница может быть помещена в <code class=\"language-text\">&lt;frame></code> или <code class=\"language-text\">&lt;iframe></code> без вашего согласия. Это может привести, в частности, к кликджекинг атакам. Clickjacking - это метод обмана пользователя, заставляющий его взаимодействовать со страницей, отличной от той, которую он видит. Этого можно добиться, запустив вашу страницу с вредоносным содержимым, с помощью iframing. В этом содержимом хакер может наложить на вашу страницу скрытый слой. Скрытые кнопки могут быть использованы для запуска плохих сценариев.</p>\n<p>Чтобы браузер не помещал вашу веб-страницу в iframe нужно послать ему заголовок X-Frame-Options. Когда браузеры загружают iframes, они проверяют значение заголовка X-Frame-Options и прерывают загрузку, если это не разрешено.</p>\n<p>Заголовок имеет три варианта:</p>\n<p><code class=\"language-text\">X-Frame-Options: DENY</code> не позволит никому помещать эту страницу в iframe.\n<code class=\"language-text\">X-Frame-Options: SAMEORIGIN</code> только вы можете поместить свои собственные страницы в iframes, и никто другой .\n<code class=\"language-text\">X-Frame-Options: ALLOW-FROM http://example.com</code> позволит только сайту <a href=\"http://example.com\">http://example.com</a> поместить вашу страницу в iframe, и никому больше. (Параметр ALLOW-FROM заголовка не поддерживается во многих браузерах. Эти браузеры будут игнорировать весь заголовок, и фрейм будет отображаться, поэтому вам следует избегать использования этой опции.)</p>\n<p>В Helmet есть промежуточный обработчик <code class=\"language-text\">helmet.frameguard()</code>, который устанавливает заголовок X-Frame-Options.</p>\n<p>Обработчик можно использовать как часть Helmet:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">var</span> helmet <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'helmet'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>helmet<span class=\"token punctuation\">.</span><span class=\"token function\">frameguard</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">action</span><span class=\"token operator\">:</span> <span class=\"token string\">'sameorigin'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Можно, также, использовать его в качестве автономного модуля:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">//Убедитесь, что вы запустили \"npm install frameguard\", чтобы получить пакет Frameguard.</span>\n<span class=\"token keyword\">const</span> frameguard <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'frameguard'</span><span class=\"token punctuation\">)</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span><span class=\"token function\">frameguard</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">action</span><span class=\"token operator\">:</span> <span class=\"token string\">'deny'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2><code class=\"language-text\">helmet.xssFilter()</code> уменьшает риск межсайтовых скриптовых атак (XSS)</h2>\n<p>Межсайтовые скриптинг (XSS) - это частый тип атак, когда вредоносные скрипты вводятся на уязвимые страницы с целью кражи конфиденциальных данных, таких как сеансовые cookie или пароли. Цель атаки XSS - получить контроль над JavaScript в браузере жертвы. После того, как хакер сделал это, есть много неприятных вещей, которые он может сделать: регистрировать ваши действия, выдавать себя за вас, красть ваши аутентификационные файлы cookie и многое другое.</p>\n<p>Один из видов XSS называется “Reflected XSS”. Как правило, он работает, устанавливая строку запроса, которая помещается непосредственно в HTML. Включение JavaScript в строку запроса может позволить злоумышленнику выполнить свой JavaScript, просто предоставив кому-то вредоносную строку запроса.</p>\n<p>Основное правило для снижения риска XSS атак очень простое: “никогда не доверяйте вводу пользователя”. Как разработчик вы всегда должны очищать все входные данные, поступающие извне. Это включает в себя данные, поступающие из форм, URL-адреса запросов GET и даже из тел сообщений. Очистка означает, что вы должны найти и закодировать символы, которые могут быть опасны, например &#x3C;,>.</p>\n<p>Современные браузеры могут помочь снизить риск, приняв более эффективные стратегии программного обеспечения. Часто они настраиваются с помощью HTTP-заголовков.</p>\n<p>HTTP-заголовок X-XSS-Protection является базовой защитой. Браузер обнаруживает потенциальный введенный сценарий с помощью эвристического фильтра. Если заголовок включен, браузер изменяет код скрипта, нейтрализуя его.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// Убедитесь, что вы установили пакет Helmet с помощью \"npm install helmet\".</span>\n<span class=\"token keyword\">const</span> helmet <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'helmet'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// Устанавливает \"X-XSS-Protection: 1; mode=block\".</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>helmet<span class=\"token punctuation\">.</span><span class=\"token function\">xssFilter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Более подробно о helmet.xssFilter() читайте <a href=\"https://helmetjs.github.io/docs/xss-filter/\">здесь</a>.</p>\n<h2><code class=\"language-text\">helmet.noSniff()</code> не позволяет клиенту угатывать в ответе MIME-тип</h2>\n<p>Когда поступает ответ от сервера, браузеры могут использовать MIME-сниффинг для адаптации к различным типам данных. MIME-сниффинг - это способ определения MIME-типов у файлов, которые поступают к клиенту от сервера. Изображения PNG имеют MIME-тип <code class=\"language-text\">image/png</code>; файлы JSON - <code class=\"language-text\">application/json</code>; файлы JavaScript имеют, обычно, MIME-тип <code class=\"language-text\">text/javascript</code>.</p>\n<p>MIME-сниффинг может быть вектором атаки. Пользователь может загрузить файл изображения с расширением <code class=\"language-text\">.jpg</code>, но его содержимое на самом деле будет HTML. И когда вы захотите просмотреть это изображение, браузер “запустит” HTML-страницу, которая может содержать вредоносный JavaScript код. Пожалуй, самая отвратительная атака называется <a href=\"https://miki.it/blog/2014/7/8/abusing-jsonp-with-rosetta-flash/\">Rosetta Flash</a>, которая позволяет кому-то загружать вредоносный Flash-плагин вместо данных!</p>\n<p>Чтобы предотвратить сниффинг MIME-типов, нужно установить заголовок <code class=\"language-text\">X-Content-Type-Options</code> в <code class=\"language-text\">nosniff</code>. Это заставит браузеры доверять тому, что говорит сервер, и блокировать ресурс, если он ошибается.</p>\n<p>Helmet имеет промежуточный обработчик noSniff, который устанавливает заголовок X-Content-Type-Options в nosniff для каждого запроса, и предотвращает попытки браузеров угадать MIME-тип.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// Убедитесь, что вы установили пакет Helmet с помощью \"npm install helmet\".</span>\n<span class=\"token keyword\">const</span> helmet <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'helmet'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// Устанавливает \"X-Content-Type-Options: nosniff\".</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>helmet<span class=\"token punctuation\">.</span><span class=\"token function\">noSniff</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Более подробно о <code class=\"language-text\">helmet.noSniff()</code> читайте <a href=\"https://helmetjs.github.io/docs/dont-sniff-mimetype/\">здесь</a>.</p>\n<h2><code class=\"language-text\">helmet.ieNoOpen()</code> не допускает, чтобы IE открывал ненадежный HTML</h2>\n<p>Эта атака затрагивает только старые версии Internet Explorer.</p>\n<p>Некоторые веб-приложения могут запускать ненадежный HTML при загрузке. Например, вы можете разрешить пользователям загружать и скачивать HTML-файлы. По умолчанию старые версии Internet Explorer позволяют открывать эти HTML-файлы в контексте вашего сайта, что означает, что ненадежная HTML-страница может начать делать плохие вещи в контексте ваших страниц. Дополнительные сведения см. <a href=\"https://blogs.msdn.microsoft.com/ie/2008/07/02/ie8-security-part-v-comprehensive-protection/\">в этом посте MSDN</a>.</p>\n<p>В Helmet есть промежуточный обработчик ieNoOpen, который устанавливает заголовок <code class=\"language-text\">X-Download-Options</code> в значение <code class=\"language-text\">no open</code> для предотвращения открытия скачанных файлов в контексте вашего сайта.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// Убедитесь, что вы установили пакет Helmet с помощью \"npm install helmet\".</span>\n<span class=\"token keyword\">const</span> helmet <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'helmet'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// Устанавливает \"X-Download-Options: noopen\".</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>helmet<span class=\"token punctuation\">.</span><span class=\"token function\">ieNoOpen</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Более подробно о <code class=\"language-text\">helmet.ieNoOpen()</code> читайте <a href=\"https://helmetjs.github.io/docs/ienoopen/\">здесь</a>.</p>\n<h2><code class=\"language-text\">helmet.hsts()</code> просит браузеры получать доступ к вашему сайту только через HTTPS</h2>\n<p>HTTP Strict Transport Security (HSTS) - это политика веб-безопасности, которая помогает защитить веб-сайты от атак низкоуровневого протокола и перехвата файлов cookie. Если ваш сайт доступен по протоколу HTTPS, вы можете попросить браузеры пользователей избегать использования небезопасного HTTP. Установив заголовок <code class=\"language-text\">Strict-Transport-Security</code>, вы говорите браузерам использовать HTTPS для будущих запросов в течение заданного промежутка времени. Это будет работать для запросов, поступающих после первоначального запроса.</p>\n<p>Заголовок HTTP <code class=\"language-text\">Strict-Transport-Security</code> говорит браузерам придерживаться HTTPS и никогда не посещать небезопасную версию HTTP. Как только браузер увидит этот заголовок, он будет посещать сайт только по протоколу HTTPS в течение следующих 60 дней:</p>\n<p>Strict-Transport-Security: max-age=5184000</p>\n<p>С помощью Helmet установить заголовок можно так</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// Убедитесь, что вы установили пакет Helmet с помощью \"npm install helmet\".</span>\n<span class=\"token keyword\">const</span> helmet <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'helmet'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// Устанавливает \"Strict-Transport-Security: max-age=5184000\";</span>\n<span class=\"token comment\">// директива includeSubDomains включена по умолчанию.</span>\n<span class=\"token keyword\">const</span> sixtyDaysInSeconds <span class=\"token operator\">=</span> <span class=\"token number\">5184000</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>helmet<span class=\"token punctuation\">.</span><span class=\"token function\">hsts</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">maxAge</span><span class=\"token operator\">:</span> sixtyDaysInSeconds\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Обратите внимание, что заголовок не будет указывать пользователям, использующим HTTP переключаться на HTTPS, он просто скажет пользователям HTTPS оставаться на этом протоколе. Вы можете применить HTTPS с помощью модуля <a href=\"https://github.com/aredo/express-enforces-ssl\">express-enforces-ssl</a>.</p>\n<p>Директива includeSubDomains включена по умолчанию. Чтобы не распространять это правило на поддомены, установите для параметра includeSubDomains значение false.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> sixtyDaysInSeconds <span class=\"token operator\">=</span> <span class=\"token number\">5184000</span><span class=\"token punctuation\">;</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>helmet<span class=\"token punctuation\">.</span><span class=\"token function\">hsts</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">maxAge</span><span class=\"token operator\">:</span> sixtyDaysInSeconds<span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">includeSubDomains</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Примечание: настройка HTTPS на веб-сайте требует приобретения домена и сертификата SSL/TSL.</p>\n<p>Более подробно о <code class=\"language-text\">helmet.hsts()</code> читайте <a href=\"https://helmetjs.github.io/docs/hsts/\">здесь</a>.</p>\n<h2><code class=\"language-text\">helmet.dnsPrefetchControl()</code> отключает предварительную выборку DNS</h2>\n<p>Для повышения производительности большинство браузеров предварительно выбирают DNS-записи для ссылок на странице. Таким образом, конечный ip-адрес уже известен, когда пользователь нажимает на ссылку. Это может привести к чрезмерному использованию службы DNS (если у вас есть большой сайт, посещаемый миллионами людей…), проблемам с конфиденциальностью (один подслушивающий может сделать вывод, что вы находитесь на определенной странице) или изменению статистики страниц (некоторые ссылки могут появиться посещенными, даже если они не являются таковыми). Если у вас есть высокие требования к безопасности, вы можете отключить предварительную выборку DNS, за счет снижения производительности.</p>\n<p>Заголовок X-DNS-Prefetch-Control сообщает браузерам, следует ли им выполнять предварительную выборку DNS. Включение его может не сработать — не все браузеры поддерживают его во всех ситуациях — но выключение должно отключить его во всех поддерживаемых браузерах.</p>\n<p>Чтобы отключить предварительную выборку DNS, установите заголовок <code class=\"language-text\">X-DNS-Prefetch-Control</code> в положение <code class=\"language-text\">off</code>. Чтобы попытаться включить его, установите значение <code class=\"language-text\">on</code>.</p>\n<p>Большинство браузеров не выполняют предварительную выборку DNS, поэтому большинство браузеров могут игнорировать этот заголовок.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// Убедитесь, что вы установили пакет Helmet с помощью \"npm install helmet\".</span>\n<span class=\"token keyword\">const</span> helmet <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'helmet'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// Устанавливает \"X-DNS-Prefetch-Control: off\".</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>helmet<span class=\"token punctuation\">.</span><span class=\"token function\">dnsPrefetchControl</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Более подробно о <code class=\"language-text\">helmet.dnsPrefetchControl()</code> читайте <a href=\"https://helmetjs.github.io/docs/dns-prefetch-control/\">здесь</a>.</p>\n<h2><code class=\"language-text\">helmet.noCache()</code> отключает кэширование на стороне клиента</h2>\n<p>Это промежуточный обработчик устарел. Он будет удален в Helmet 4. Вы все еще можете прочитать документацию <a href=\"https://helmetjs.github.io/docs/nocache/\">здесь</a>.</p>\n<p>Если вы выпускаете обновление для своего веб-сайта и хотите, чтобы пользователи всегда загружали более новую версию, вы можете (попытаться) отключить кэширование в браузере клиента. Это может быть полезно и при разработке. Кэширование увеличивает производительность, поэтому отключайте кэширование только тогда, когда есть реальная необходимость.</p>\n<p>Этот модуль не защищает от конкретной атаки. Он не позволяет пользователям получать кэшированные версии ваших файлов (например, старый JavaScript).</p>\n<p>Представьте, что у вас есть фронтенд веб-приложение, которое работает на JavaScript. И вы обнаружили, что одна из ваших JavaScript библиотек имеет уязвимость, естесственно, вы обновите ее и обновите свой сайт. Но пользователи могут получить старые, кэшированные версии вашего кода, которые все еще имеют эту уязвимость.</p>\n<p>Кэширование имеет много преимуществ, но это может привести к тому, что пользователи получат устаревшие версии.</p>\n<p>Модуль <code class=\"language-text\">helmet.noCache()</code> устанавливает четыре HTTP-заголовка кэширования: <code class=\"language-text\">Cache-Control</code>, <code class=\"language-text\">Surrogate-Control</code>, <code class=\"language-text\">Pragma</code> и <code class=\"language-text\">Expires</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// Убедитесь, что вы установили пакет Helmet с помощью \"npm install helmet\".</span>\n<span class=\"token keyword\">const</span> noCache <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'nocache'</span><span class=\"token punctuation\">)</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>helmet<span class=\"token punctuation\">.</span><span class=\"token function\">noCache</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Более подробно о <code class=\"language-text\">helmet.noCache()</code> читайте <a href=\"https://helmetjs.github.io/docs/nocache/\">здесь</a>.</p>\n<h2>helmet.contentSecurityPolicy() устанавливает политику безопасности контента</h2>\n<p>Хакеры могут сделать много плохого, если они смогут разместить на ваши веб-страницы JavaScript, CSS, плагины и многое другое.</p>\n<p>Одна из хитростей этих инъекционных атак заключается в том, что браузер не знает, что хорошо, а что плохо. Как он может определить разницу между легальным файлом JavaScript и вредоносным? Во многих случаях это невозможно…, если только вы не определили политику безопасности контента (Content Security Policy, или CSP).</p>\n<p>Самая отвратительная атака - это, вероятно, межсайтовый скриптинг (XSS), когда хакер помещает вредоносный JavaScript код на вашу страницу. Если хакеру удастся запустить JavaScript на вашей странице, то он сможет сделать много плохого, от кражи аутентификационных cookies до регистрирования каждого действия пользователя.</p>\n<p>Но даже если злоумышленники не смогут выполнить JavaScript, они могут сделать, много чего другого. Например, если возможно поместить крошечное, прозрачное изображение размером 1x1 на ваш сайт, то можно получить довольно хорошее представление о том, сколько трафика получает ваш сайт. Если возможно запустить уязвимый плагин для браузера, такой как Flash, то можно использовать его недостатки и делать много нехороших вещей.</p>\n<p>Большинство современных браузеров поддерживают HTTP заголовок под названием <code class=\"language-text\">Content-Security-Policy</code>, который фактически является белым списком вещей, которые могут быть на вашей странице. Вы можете внести в белый список JavaScript, CSS, изображения, плагины и многое другое. Вещи включаются выборочно, поэтому вы говорите, “этот материал разрешен” вместо “этот материал не разрешен”.</p>\n<p>Допустим, у вас есть веб-сайт, который вообще не ссылается на внешние ресурсы — только ваши материалы. Вы можете установить заголовок, который выглядит следующим образом:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Content-Security-Policy: default-src 'self'</code></pre></div>\n<p>Это фактически говорит браузеру “загружайте только те вещи, которые находятся в моем домене”. Если ттвой сайт - example.com и пользователь пытается загрузить <a href=\"https://example.com/my-javascript.js\">https://example.com/my-javascript.js</a>, то это сработает. Но если пользователь попытается загрузить <a href=\"http://evil.com/evil.js\">http://evil.com/evil.js</a> - оно вообще не будет загружаться!</p>\n<p>Теперь предположим, что вы хотите также разрешить CSS из CDN Bootstrap. Вы можете установить CSP, который выглядит следующим образом:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Content-Security-Policy: default-src 'self'; style-src 'self' maxcdn.bootstrapcdn.com</code></pre></div>\n<p>Теперь у нас есть белый список ‘self’ и maxcdn.bootstrapcdn.com. Пользователь сможет загрузить оттуда CSS, но ничего больше. Пользователь даже не сможет загрузить JavaScript или изображения с этого URL-адреса - только таблицы стилей.</p>\n<p>CSP работает, определяя белый список источников контента, которым доверяют. Вы можете настроить их для каждого вида ресурсов, которые могут понадобиться веб-странице (скрипты, таблицы стилей, шрифты, фреймы, медиа и т. д.). Существует несколько доступных директив, поэтому владелец веб-сайта может иметь детализированный контроль. К сожалению, CSP не поддерживается старыми браузерами.</p>\n<p>В CSP есть много нюансов: то, что вы можете и не можете внести в белый список, поддержка браузером различных функций и альтернативные заголовки. См. материалы ниже для получения дополнительной информации.</p>\n<ul>\n<li><a href=\"http://www.html5rocks.com/en/tutorials/security/content-security-policy/\">An introduction to Content Security Policy on HTML5 Rocks</a></li>\n<li><a href=\"https://content-security-policy.com/\">Content Security Policy Reference</a></li>\n<li><a href=\"http://caniuse.com/#feat=contentsecuritypolicy\">Can I Use Content Security Policy 1.0</a></li>\n<li><a href=\"http://caniuse.com/#feat=contentsecuritypolicy2\">Can I Use Content Security Policy 2.0</a></li>\n</ul>\n<p>Модуль Helmet csp помогает устанавливать политику безопасности контента.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">//  Убедитесь, что вы установили пакет Helmet с помощью \"npm install helmet\".</span>\n<span class=\"token keyword\">const</span> helmet <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'helmet'</span><span class=\"token punctuation\">)</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>helmet<span class=\"token punctuation\">.</span><span class=\"token function\">contentSecurityPolicy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">directives</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">defaultSrc</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"'self'\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">styleSrc</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"'self'\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'maxcdn.bootstrapcdn.com'</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Все ваши директивы CSP (например, default-src, style-src) помещаются под параметром directives.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">app<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>helmet<span class=\"token punctuation\">.</span><span class=\"token function\">contentSecurityPolicy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">directives</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">defaultSrc</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"'self'\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'default.com'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">scriptSrc</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"'self'\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"'unsafe-inline'\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">sandbox</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'allow-forms'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'allow-scripts'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">reportUri</span><span class=\"token operator\">:</span> <span class=\"token string\">'/report-violation'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">objectSrc</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"'none'\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">upgradeInsecureRequests</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">workerSrc</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span>  <span class=\"token comment\">// Это не установлено.</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Директивы можно записывать в виде kebab-cased (например, script-src) или camel-cased (например, scriptSrc); эти записи эквивалентны.</p>\n<p>Поддерживаются следующие директивы:</p>\n<ul>\n<li>base-uri or baseUri</li>\n<li>block-all-mixed-content or blockAllMixedContent</li>\n<li>child-src or childSrc</li>\n<li>connect-src or connectSrc</li>\n<li>default-src or defaultSrc</li>\n<li>font-src or fontSrc</li>\n<li>form-action or formAction</li>\n<li>frame-ancestors or frameAncestors</li>\n<li>frame-src or frameSrc</li>\n</ul>\n<p>-img-src or imgSrc</p>\n<ul>\n<li>manifest-src or manifestSrc</li>\n<li>media-src or mediaSrc</li>\n<li>object-src or objectSrc</li>\n<li>plugin-types or pluginTypes</li>\n<li>prefetch-src or prefetchSrc</li>\n<li>report-to or reportTo</li>\n<li>report-uri or reportUri</li>\n<li>require-sri-for or requireSriFor</li>\n<li>sandbox or sandbox</li>\n<li>script-src or scriptSrc</li>\n<li>style-src or styleSrc</li>\n<li>upgrade-insecure-requests or upgradeInsecureRequests</li>\n<li>worker-src or workerSrc</li>\n</ul>\n<h3>Нарушения CSP</h3>\n<p>Если вы указали <code class=\"language-text\">reportUri</code>, браузеры будут публиковать любые нарушения CSP на вашем сервере. Вот простой пример маршрута Express, который обрабатывает эти отчеты:</p>\n<p>Нет ни одной конкретной атаки, которую модуль CSP предотвращает. Главное вот что: вы не хотите, чтобы кто-то поместил на ваши веб-страницы то, чего вы не ожидаете.</p>\n<p>По умолчанию директивы широко открыты, поэтому важно установить директиву defaultSrc в качестве запасного варианта. Helmet поддерживает как defaultSrc, так и, по умолчанию, стили, называемые src. Резервный вариант применяется для большинства неопределенных директив.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// Сначала вам нужен парсер JSON.</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>bodyParser<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'json'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'application/csp-report'</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/report-violation'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'CSP Violation: '</span><span class=\"token punctuation\">,</span> req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'CSP Violation: No data received!'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  res<span class=\"token punctuation\">.</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token number\">204</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">end</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Не все браузеры отсылают нарушения CSP одинаково, поэтому это может потребовать небольшой работы.</p>\n<p>Примечание: Если вы используете модуль CSRF, например, такой как <a href=\"https://github.com/expressjs/csurf\">csurf</a>, у вас могут возникнуть проблемы с обработкой этих нарушений без валидного CSRF токена. Решить проблему можно, если расположить маршрут отчета CSP выше промежуточного обработчика csurf.</p>\n<p>Опция <code class=\"language-text\">reportOnly</code> этого модуля будет переключать заголовок <code class=\"language-text\">Content-Security-Policy-Report-Only</code>. Это дает браузеру указание сообщать о нарушениях в <code class=\"language-text\">reportUri</code> (если указано), но он не блокирует загрузку каких-либо ресурсов.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">app<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>helmet<span class=\"token punctuation\">.</span><span class=\"token function\">contentSecurityPolicy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">directives</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">reportOnly</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Вы также можете установить это в функцию, чтобы динамически решать, следует ли использовать режим <code class=\"language-text\">reportOnly</code>. Вы могли бы использовать это для динамического отключения. Эта функция будет вызываться вместе с объектами запроса и ответа и должна возвращать логическое значение.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">app<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>helmet<span class=\"token punctuation\">.</span><span class=\"token function\">contentSecurityPolicy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">directives</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">reportOnly</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> req<span class=\"token punctuation\">.</span>query<span class=\"token punctuation\">.</span>cspmode <span class=\"token operator\">===</span> <span class=\"token string\">'debug'</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3>Браузерный сниффинг</h3>\n<p>По умолчанию этот модуль будет просматривать входящий заголовок <code class=\"language-text\">User-Agent</code> и отправлять различные заголовки в зависимости от обнаруженного браузера. Например, Chrome до версии 25 использует альтернативный заголовок под названием <code class=\"language-text\">X-WebKit-CSP</code>, и этот модуль обрабатывает его. Если браузер не обнаружен, этот модуль установит все заголовки со спецификацией 2.0.</p>\n<p>Чтобы отключить браузерный сниффинг и считать его современным браузером, установите для параметра <code class=\"language-text\">browserSniff</code> значение <code class=\"language-text\">false</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">app<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>helmet<span class=\"token punctuation\">.</span><span class=\"token function\">contentSecurityPolicy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">directives</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">browserSniff</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Чтобы установить все заголовки, включая устаревшие, установите для параметра <code class=\"language-text\">setAllHeaders</code> значение <code class=\"language-text\">true</code>. Обратите внимание, что это изменит значение заголовков на основе <code class=\"language-text\">User-Agent</code>. Вы можете отключить это, используя опцию <code class=\"language-text\">browserSniff: false</code> выше.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">app<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>helmet<span class=\"token punctuation\">.</span><span class=\"token function\">contentSecurityPolicy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">directives</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">setAllHeaders</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Старые браузеры Android могут быть очень глючными. По умолчанию, это значение равно false.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">app<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>helmet<span class=\"token punctuation\">.</span><span class=\"token function\">contentSecurityPolicy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">directives</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">disableAndroid</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3>Генерация nonces</h3>\n<p>Вы можете динамически генерировать <code class=\"language-text\">nonces</code>, чтобы позволить встроенным тегам <script> безопасно анализироваться. Вот простой пример:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> uuidv4 <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'uuid/v4'</span><span class=\"token punctuation\">)</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">,</span> next</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  res<span class=\"token punctuation\">.</span>locals<span class=\"token punctuation\">.</span>nonce <span class=\"token operator\">=</span> <span class=\"token function\">uuidv4</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>helmet<span class=\"token punctuation\">.</span><span class=\"token function\">contentSecurityPolicy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">directives</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">scriptSrc</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token string\">\"'self'\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">'nonce-</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>res<span class=\"token punctuation\">.</span>locals<span class=\"token punctuation\">.</span>nonce<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">'</span><span class=\"token template-punctuation string\">`</span></span>  <span class=\"token comment\">// 'nonce-614d9122-d5b0-4760-aecf-3a5d17cf0ac9'</span>\n    <span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  res<span class=\"token punctuation\">.</span><span class=\"token function\">end</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;script nonce=\"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>res<span class=\"token punctuation\">.</span>locals<span class=\"token punctuation\">.</span>nonce<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\">alert(1 + 1);&lt;/script></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3>Использование CSP с CDN</h3>\n<p>Поведение CSP по умолчанию - это создание заголовков, адаптированных для браузера, который запрашивает вашу страницу. Если у вас есть CDN перед вашим приложением, CDN может кэшировать неправильные заголовки, что делает ваш CSP бесполезным. Убедитесь, что CDN не используется, когда используется этот модуль, или установите параметр <code class=\"language-text\">browserSniff</code> в значение <code class=\"language-text\">false</code>.</p>\n<p>Более подробно о <code class=\"language-text\">helmet.contentSecurityPolicy()</code> читайте <a href=\"https://helmetjs.github.io/docs/csp/\">здесь</a>.</p>\n<h2>Настройка Helmet используя ‘родительский’ промежуточный обработчик helmet()</h2>\n<p>app.use(helmet()) автоматически включает все промежуточные обработчики, представленное выше, за исключением noCache() и contentSecurityPolicy(), но они могут быть включены при необходимости. Вы также можете отключить или настроить любые другие промежуточные обработчики индивидуально, используя объект конфигурации.</p>\n<p>Пример:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">app<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span><span class=\"token function\">helmet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">frameguard</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>         <span class=\"token comment\">// конфигурирование</span>\n    <span class=\"token literal-property property\">action</span><span class=\"token operator\">:</span> <span class=\"token string\">'deny'</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">contentSecurityPolicy</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>    <span class=\"token comment\">// включение и конфигурирование</span>\n    <span class=\"token literal-property property\">directives</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">defaultSrc</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"self\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">styleSrc</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'style.com'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">dnsPrefetchControl</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span>     <span class=\"token comment\">// отключение</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>В этом руководстве каждый промежуточный обработчик показан отдельно для целей обучения. Использование ‘родительского’ промежуточного обработчика <code class=\"language-text\">helmet()</code> легко реализовать в реальном проекте.</p>","frontmatter":{"title":"Информационная безопасность с HelmetJS","date":"16 April 2020","description":"Модуль HelmetJS - это набор функций middleware, которые устанавливают определенные HTTP-заголовки для обеспечения безопасности."}}},"pageContext":{"slug":"/Express/HelmetJS/","previous":{"fields":{"slug":"/gatsby/wordpress-source-plugin-tutorial/"},"frontmatter":{"title":"Руководство по плагину WordPress Source"}},"next":{"fields":{"slug":"/Express/bcrypt/"},"frontmatter":{"title":"BCrypt хэширование"}}}},
    "staticQueryHashes": ["63159454","71715879"]}