{"componentChunkName":"component---src-templates-blog-post-js","path":"/Sozdanie-saytov/Nastrojka-NPM-dlya-staticheskogo-sajta/","result":{"data":{"site":{"siteMetadata":{"title":"jinv.ru"}},"markdownRemark":{"id":"5dbaf5f1-d11b-5826-99b0-54f77341f279","excerpt":"О чем статья В статье показано, как настроить собственную сборку из модулей NPM, которая является полным аналогом сборки npm-for-frontend. Эта сборка позволит…","html":"<h2>О чем статья</h2>\n<p>В статье показано, как настроить собственную сборку из модулей NPM, которая является полным аналогом сборки <a href=\"https://github.com/injashkin/npm-for-frontend\">npm-for-frontend</a>. Эта сборка позволит создавать статические страницы сайта, а именно:</p>\n<ul>\n<li>Создавать разметку с помощью шаблонизатора Pug.</li>\n<li>Стилизовать страницы с помощью препроцессора Sass.</li>\n<li>Наполнять содержимое страниц сайта с помощью разметки Markdown.</li>\n<li>Добавлять картинки, значки, шрифты.</li>\n<li>Добавлять интерактив на сайт используя самые последние достижения языка JavaScript и при этом не переживать, что какая-то новая функция не будет распознана старым браузером.</li>\n</ul>\n<p>Сама сборка будет выполнять следующие функции:</p>\n<ul>\n<li>Автоматически преобразовывать Pug разметку и разметку Markdown в понятный для браузеров HTML</li>\n<li>Автоматически преобразовывать Sass стили и объединять их в один файл <code class=\"language-text\">index.css</code>.</li>\n<li>Все скрипты будут транспилированы и упакованы в один файл <code class=\"language-text\">index.js</code>.</li>\n<li>Автоматически оптимизировать картинки, значки, шрифты для увеличения быстродействия готового сайта.</li>\n</ul>\n<h2>Быстрый запуск проекта</h2>\n<p>Чтобы выполнять дальнейшие действия у нас на компьютере должен быть установлен <a href=\"https://nodejs.org/\">Node.js</a> и NPM.</p>\n<p>Откроем терминал и создадим каталог <code class=\"language-text\">my-project</code> нашего будущего проекта, и сразу перейдем в него:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">mkdir my-project\ncd my-project</code></pre></div>\n<p>Теперь, если нам нужна система контроля версий Git, то выполним два простых шага, сначала, инициализируем Git:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">git init</code></pre></div>\n<p>Затем создадим файл <code class=\"language-text\">.gitignore</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">touch .gitignore</code></pre></div>\n<p>В этом файле будем указывать игнорируемые файлы и каталоги, которые не должны попадать в коммиты. Если файл <code class=\"language-text\">.gitignore</code> не виден в каталоге, то нужно нажать сочетание клавиш <code class=\"language-text\">Ctrl+H</code>. Запишем в файле <code class=\"language-text\">.gitignore</code> следующее:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">node_modules</code></pre></div>\n<p>С настройками Git в этом проекте покончено. Теперь не забываем, хотя бы иногда, делать коммиты.</p>\n<p>Инициализируем npm. Для этого введем в терминале команду:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm init -y</code></pre></div>\n<p>Будет создан файл <code class=\"language-text\">package.json</code> с настройками по умолчанию (опция -y). Наиболее полную информацию о файле package.json можно прочитать в <a href=\"https://docs.npmjs.com/cli/v8/configuring-npm/package-json\">документации по npm</a>.</p>\n<h2>Подключение и настройка шаблонизатора Pug</h2>\n<p>В настоящее время мало кто верстает на чистом HTML. Придуманы более удобные для написания языки и инструменты, которые эти языки преобразуют в HTML. Одним из таких инструментов является <a href=\"https://pugjs.org/\">шаблонизатор Pug</a>, который имеет свой, более удобный синтаксис для написания разметки. После компиляции синтаксис Pug превращается в разметку HTML.</p>\n<p>Установим pug. Для этого введем в терминале команду:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm i -D pug-cli</code></pre></div>\n<p>Вместо опции <code class=\"language-text\">i</code> можно написать <code class=\"language-text\">install</code>. Опция <code class=\"language-text\">-D</code> указывает, что устанавливаемый пакет нужен только для разработки и не будет использоваться в производственной сборке. Поэтому, устанавливаемый пакет будет прописан в секции <code class=\"language-text\">\"devDependencies\": {...}</code> файла <code class=\"language-text\">package.json</code>.</p>\n<p>В результате, в корневом каталоге проекта будет создан каталог <code class=\"language-text\">node_modules</code> и файл <code class=\"language-text\">package-lock.json</code>. Каталог <code class=\"language-text\">node_modules</code> содержит все установленные зависимости проекта. Обычно этот каталог не рекомендуется включать в репозитории, что мы и сделали, проигнорировав его в файле <code class=\"language-text\">.gitignore</code>. Файл <code class=\"language-text\">package-lock.json</code> хранит записи о точных версиях установленных зависимостей.</p>\n<p>Создадим в корне проекта каталог <code class=\"language-text\">src</code>, в котором создадим каталог <code class=\"language-text\">pages</code>, в нем создадим каталог <code class=\"language-text\">home</code>, а уже в нем создадим файл <code class=\"language-text\">index.pug</code> со следующим содержимым:</p>\n<p><strong>src/pages/home/index.pug</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"pug\"><pre class=\"language-pug\"><code class=\"language-pug\"><span class=\"token tag\">h1<span class=\"token attr-class\">.name</span></span><span class=\"token punctuation\">=</span><span class=\"token code\"> <span class=\"token string\">'Код написан с помощью разметки Pug!'</span></span></code></pre></div>\n<p>Сохраним файл.</p>\n<p>Создание каталогов здесь и далее может быть произвольным, но исходя из опыта лучше сразу придерживаться определенной структуры, чтобы потом мучительно не переделывать проект.</p>\n<p>Настроим Pug для работы. Для этого добавим в секцию <code class=\"language-text\">\"scripts\"</code> файла <code class=\"language-text\">package.json</code> скрипт с именем <code class=\"language-text\">\"pug\"</code> (знак плюс <code class=\"language-text\">+</code> дальше по тексту будет лишь указывать на добавленные строки кода):</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"my-project\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"version\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1.0.0\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"main\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"index.js\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n+   <span class=\"token property\">\"pug\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"pug --pretty -w src/pages/home/index.pug -o dist\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"test\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"echo \\\"Error: no test specified\\\" &amp;&amp; exit 1\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"keywords\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"author\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"license\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ISC\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"devDependencies\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"pug-cli\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^1.0.0-alpha6\"</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>Опция <code class=\"language-text\">--pretty</code> (или <code class=\"language-text\">-P</code>) отключает минификацию, что дает на выходе красиво оформленную разметку HTML. По умолчанию, pug переводит код в минимизированный HTML, из которого вырезаны пробелы между тегами, табуляция и перевод строк.</li>\n<li>Ключ <code class=\"language-text\">-w</code> (или <code class=\"language-text\">--watch</code>) заставляет Pug следить за изменениями в файлах с расширениями <code class=\"language-text\">.pug</code> и как только мы сохраняем измененный файл, то Pug сразу перекомпилирует исходники.</li>\n<li>Путь <code class=\"language-text\">src/pages/home/index.pug</code> указывает на входной файл. Этот файл после компиляции будет на выходе с расширением <code class=\"language-text\">.html</code>. Если мы укажем каталог, то все файлы с расширением <code class=\"language-text\">.pug</code> этого каталога появятся на выходе с расширением <code class=\"language-text\">.html</code>, что не всегда бывает нужно.</li>\n<li>Ключ <code class=\"language-text\">-o</code> (или <code class=\"language-text\">--out</code>) указывает, что откомпилированные файлы будут выводится в другой каталог. Этот каталог нужно указать сразу после ключа, в нашем случае это каталог <code class=\"language-text\">dist</code>. Если такого каталога не существует, он будет создан.</li>\n<li><code class=\"language-text\">dist</code> - это каталог, в который будут компилироваться файлы. Можно указать имя конкретного файла, который должен получится на выходе, например, <code class=\"language-text\">dist/index.html</code>. Тогда ключ <code class=\"language-text\">-o</code> следует опустить, иначе имя файла будет воспринято как имя каталога. К тому же, все каталоги, указанные в пути должны существовать, так как без ключа <code class=\"language-text\">-o</code> каталоги не создаются.</li>\n</ul>\n<p>Более подробно об опциях командной строки можно узнать в <a href=\"https://github.com/pugjs/pug-cli\">репозитории pug-cli</a></p>\n<p>После установки и конфигурации шаблонизатора Pug проверим его в работе. Из корневого каталога проекта запустим в терминале команду:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm run pug</code></pre></div>\n<p>Будет создан каталог <code class=\"language-text\">dist</code>, а в нем файл <code class=\"language-text\">index.html</code>. Если мы откроем этот файл в браузере, то увидим следующее:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Код написан с помощью разметки Pug!</code></pre></div>\n<p>Если мы откроем файл <code class=\"language-text\">dist/index.html</code> в редакторе кода то увидим откомпилированную HTML разметку:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>name<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Код написан с помощью разметки Pug<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Чтобы данный файл был полноценной HTML страницей и без ошибок проходил <a href=\"https://validator.w3.org/#validate_by_upload\">валидатор</a> в файл нужно добавить теги <code class=\"language-text\">&lt;!DOCTYPE html></code>, <code class=\"language-text\">&lt;html></code>, <code class=\"language-text\">&lt;head></code>, <code class=\"language-text\">&lt;body></code> и некоторые теги <code class=\"language-text\">&lt;meta></code>. Данные теги должны присутствовать на каждой HTML странице.</p>\n<p>Чтобы не повторять во всех шаблонах Pug одинаковый код, создадим общий шаблон, который будет применятся ко всем страницам нашего сайта. Для этого в каталоге <code class=\"language-text\">src</code> создадим каталог <code class=\"language-text\">layouts</code>, внутри которого создадим каталог <code class=\"language-text\">base</code>, а в нем файл <code class=\"language-text\">index.pug</code> со следующим содержимым:</p>\n<p><strong>src/layouts/base/index.pug</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"pug\"><pre class=\"language-pug\"><code class=\"language-pug\"><span class=\"token punctuation\">-</span>\n  <span class=\"token tag\">let</span> <span class=\"token plain-text\">data = {</span>\n    <span class=\"token tag\">default_description<span class=\"token punctuation\">:</span></span> \"Показан пример общего шаблона Pug для всех страниц\",\n    <span class=\"token tag\">default_title<span class=\"token punctuation\">:</span></span> \"Общий шаблон Pug\"\n  }\n\n<span class=\"token punctuation\">-</span><span class=\"token code\"> <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>default_title<span class=\"token punctuation\">,</span> default_description<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> data</span>\n\n<span class=\"token doctype\">doctype html</span>\n<span class=\"token tag\">html<span class=\"token attributes\"><span class=\"token punctuation\">(</span><span class=\"token attr-name\">lang</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token string\">'ru'</span></span><span class=\"token punctuation\">)</span></span></span>\n  <span class=\"token tag\">head</span>\n    <span class=\"token tag\">meta<span class=\"token attributes\"><span class=\"token punctuation\">(</span><span class=\"token attr-name\">charset</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token string\">'utf-8'</span></span><span class=\"token punctuation\">)</span></span></span>\n    <span class=\"token tag\">meta<span class=\"token attributes\"><span class=\"token punctuation\">(</span><span class=\"token attr-name\">name</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token string\">'viewport'</span> content<span class=\"token operator\">=</span>'width<span class=\"token operator\">=</span>device<span class=\"token operator\">-</span>width</span><span class=\"token punctuation\">,</span> <span class=\"token attr-name\">initial-scale</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token number\">1.0</span>'</span><span class=\"token punctuation\">)</span></span></span>\n\n    <span class=\"token tag\">meta<span class=\"token attributes\"><span class=\"token punctuation\">(</span><span class=\"token attr-name\">name</span><span class=\"token punctuation\">=</span> <span class=\"token attr-value\"><span class=\"token string\">'description'</span> content<span class=\"token operator\">=</span> description <span class=\"token operator\">?</span> description <span class=\"token operator\">:</span> default_description</span><span class=\"token punctuation\">)</span></span></span>\n    <span class=\"token tag\">title</span><span class=\"token punctuation\">=</span><span class=\"token code\"> title <span class=\"token operator\">?</span> title <span class=\"token operator\">:</span> default_title</span>\n\n  <span class=\"token tag\">body</span>\n    <span class=\"token keyword\">block main</span></code></pre></div>\n<p>Содержимое файла <code class=\"language-text\">src/pages/home/index.pug</code> изменим на следующее:</p>\n<div class=\"gatsby-highlight\" data-language=\"pug\"><pre class=\"language-pug\"><code class=\"language-pug\"><span class=\"token keyword\">extends ../../layouts/base/index</span>\n\n<span class=\"token keyword\">block main</span>\n  <span class=\"token tag\">h1<span class=\"token attr-class\">.name</span></span><span class=\"token punctuation\">=</span><span class=\"token code\"> <span class=\"token string\">'Код написан с помощью разметки Pug!'</span></span></code></pre></div>\n<p>Теперь, если мы откроем файл <code class=\"language-text\">dist/index.html</code> в редакторе кода, мы увидим следующую разметку:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span> <span class=\"token attr-name\">lang</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>ru<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>utf-8<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>viewport<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>width=device-width, initial-scale=1.0<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span>\n      <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>description<span class=\"token punctuation\">\"</span></span>\n      <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Показан пример общего шаблона Pug для всех страниц<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>Общий шаблон Pug<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>name<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Код написан с помощью разметки Pug!<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Если мы этого не увидим, значит мы либо закрыли окно терминала с выполняемым компилятором Pug, либо что-то сделали неправильно.</p>\n<p>Проверка данного файла в <a href=\"https://validator.w3.org/#validate_by_upload\">валидаторе</a> не выявит никаких ошибок.</p>\n<p>Далее, мы создадим простую кнопку и добавим ее на страницу сайта. Реализуем кнопку с помощью миксина. Для этого создадим в каталоге <code class=\"language-text\">src</code> каталог <code class=\"language-text\">components</code>, в котором создадим каталог <code class=\"language-text\">button</code>, а в нем файл <code class=\"language-text\">button.pug</code> со следующим содержимым:</p>\n<div class=\"gatsby-highlight\" data-language=\"pug\"><pre class=\"language-pug\"><code class=\"language-pug\"><span class=\"token mixin\"><span class=\"token keyword\">mixin</span> <span class=\"token function\">button</span></span>\n  <span class=\"token tag\">button<span class=\"token attr-class\">.button</span></span><span class=\"token punctuation\">=</span><span class=\"token code\"> <span class=\"token string\">'Кнопка добавлена с помощью миксина'</span></span></code></pre></div>\n<p>Не забываем сохранить файл.</p>\n<p>В файл <code class=\"language-text\">src/pages/home/index.pug</code> подключим файл <code class=\"language-text\">button.pug</code> с помощью <code class=\"language-text\">include</code> и вызовем в нужном месте как миксин <code class=\"language-text\">+button()</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"pug\"><pre class=\"language-pug\"><code class=\"language-pug\"><span class=\"token keyword\">extends ../../layouts/base/index</span>\n<span class=\"token keyword\">include ../../components/button/button.pug</span>\n\n<span class=\"token keyword\">block main</span>\n  <span class=\"token tag\">h1<span class=\"token attr-class\">.name</span></span><span class=\"token punctuation\">=</span><span class=\"token code\"> <span class=\"token string\">'Код написан с помощью разметки Pug!'</span></span>\n  <span class=\"token mixin\"><span class=\"token name function\">+button</span></span></code></pre></div>\n<p>После сохранения файла перезагрузим страницу браузера и мы увидим заголовок, а под ним кнопку:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 568px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/18c6b33a2946c1442e56b4c9b297bfa6/10e91/added-button.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 17.567567567567565%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAyUlEQVQY042Oy66CQBBE+f8v8hGHYV4+Fhg3eqMbFsgIDDMgLHQBdUMb93ZS6arT3UlHzjXo+x5N06Cua4QQ4L3HMAzEnXPE5nkbAtq2I951Le09nx28/9xkWYZIa4O/yxmMxWCMwWgNzhPcrlcSj2MIIbBcLMA2G0ghiGmlsFqucTqmYIxjt93hmKaIivsdtihgrUVZlqiqiry1D9jiw16vN36tSEkFoxUSnsAYg8N+T18YbehbKSXyPKflcRwxTRP5uX/zV3P+B9GZJFAhJ910AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Добавлена кнопка с помощью миксина\"\n        title=\"Добавлена кнопка с помощью миксина\"\n        src=\"/static/18c6b33a2946c1442e56b4c9b297bfa6/10e91/added-button.png\"\n        srcset=\"/static/18c6b33a2946c1442e56b4c9b297bfa6/12f09/added-button.png 148w,\n/static/18c6b33a2946c1442e56b4c9b297bfa6/e4a3f/added-button.png 295w,\n/static/18c6b33a2946c1442e56b4c9b297bfa6/10e91/added-button.png 568w\"\n        sizes=\"(max-width: 568px) 100vw, 568px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>Настройка локального сервера BrowserSync</h2>\n<p>После очередного изменения кода, чтобы увидеть откомпилированный результат, нужно каждый раз вручную обновлять страницу браузера. Это очень быстро надоедает. Для того, чтобы после сохранения редактируемого файла браузер автоматически обновлял страницу можно использовать локальный сервер, такой как <a href=\"https://browsersync.io/docs/command-line\">BrowserSync</a> или <a href=\"https://github.com/ctrlaltdev/pug-server\">Pug Server</a>. Мы будем использовать сервер BrowserSync, установим его. Для этого откроем новое окно терминала, так как в первом окне у нас запущен Pug, который работает в режиме наблюдения за файлами, и, сделав рабочим корневой каталог проекта, введем следующую команду:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm i -D browser-sync</code></pre></div>\n<p>Добавим в файл <code class=\"language-text\">package.json</code> настройку, отмеченную знаком <code class=\"language-text\">+</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">  <span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"pug\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"pug --pretty -w src/pages/home/index.pug -o dist\"</span><span class=\"token punctuation\">,</span>\n+   <span class=\"token property\">\"serve\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"browser-sync dist -w\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"test\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"echo \\\"Error: no test specified\\\" &amp;&amp; exit 1\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n<p>Данный скрипт будет запускать сервер, а сервер будет наблюдать за всеми файлами в каталоге <code class=\"language-text\">dist</code>. Скрипт работает в browser-sync версии 2.23.0 и выше. Аналог данного скрипта, который будет работать в browser-sync любой версии приведен ниже:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">  <span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    ...\n    <span class=\"token property\">\"serve\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"browser-sync start -s dist -f dist\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n<p>Теперь в окне терминала выполним команду:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm run serve</code></pre></div>\n<p>В результате, откроется браузер, в котором мы увидим нашу страницу.</p>\n<p>Теперь, каждый раз, когда в каталоге <code class=\"language-text\">dist</code> происходят какие-либо изменения сервер будет автоматически обновлять браузер.</p>\n<h2>Последовательный и параллельный запуск скриптов с помощью npm-run-all</h2>\n<p>Мы видим один неприятный момент. Для того, чтобы запустить шаблонизатор Pug в режиме наблюдения мы должны открыть окно терминала и выполнить команду <code class=\"language-text\">npm run pug</code>, затем, чтобы запустить сервер, нужно открыть другое окно терминала и выполнить <code class=\"language-text\">npm run serve</code>. И так нужно поступать каждый раз, когда начинаете процесс разработки. В дальнейшем, нам понадобится запускать в режиме наблюдения препроцессор Sass, постпроцессор Postcss, компилятор Babel и др. Если на каждую такую задачу открывать окно терминала и запускать команду типа <code class=\"language-text\">npm run *</code>, то это будет рутина.</p>\n<p>Чтобы упростить процесс одновременного запуска нескольких npm-скриптов можно воспользоваться пакетами <a href=\"https://www.npmjs.com/package/concurrently\">concurrently</a> или <a href=\"https://github.com/mysticatea/npm-run-all\">npm-run-all</a>. Здесь мы воспользуемся инструментом <code class=\"language-text\">npm-run-all</code>. Сначала установим его. Для этого откроем третье окно терминала и сделав рабочим корневой каталог проекта выполним следующую команду:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm i -D npm-run-all</code></pre></div>\n<p>Затем отредактируем файл <code class=\"language-text\">package.json</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">  <span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n+   <span class=\"token property\">\"watch:pug\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"pug --pretty -w src/pages/home/index.pug -o dist\"</span><span class=\"token punctuation\">,</span>\n+   <span class=\"token property\">\"watch:serve\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"browser-sync dist -w\"</span><span class=\"token punctuation\">,</span>\n+   <span class=\"token property\">\"dev\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"npm-run-all -p watch:*\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"test\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"echo \\\"Error: no test specified\\\" &amp;&amp; exit 1\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n<p>Сохраним файл <code class=\"language-text\">package.json</code>.</p>\n<p>Мы добавили скрипт <code class=\"language-text\">\"dev\": \"npm-run-all -p watch:*\"</code>, в котором опция <code class=\"language-text\">-p</code> (или <code class=\"language-text\">--parallel</code>) указывает на параллельное выполнение скриптов, следующих за этой опцией. У нас за этой опцией следует шаблон <code class=\"language-text\">watch:*</code>. Это значит, что параллельно будут выполнятся все скрипты, у которых в названии есть <code class=\"language-text\">watch:</code>. Поэтому, мы изменили имена скриптов: имя <code class=\"language-text\">\"pug\"</code> заменили на <code class=\"language-text\">\"watch:pug\"</code>; имя <code class=\"language-text\">\"serve\"</code> заменили на <code class=\"language-text\">\"watch:serve\"</code>.</p>\n<p>Более подробно об опциях командной строки можно узнать из <a href=\"https://github.com/mysticatea/npm-run-all/blob/master/docs/npm-run-all.md\">документации инструмента npm-run-all</a></p>\n<p>Теперь, закроем все окна терминала кроме одного последнего и запустим следующую команду:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm run dev</code></pre></div>\n<p>Мы увидим, что откроется браузер со страницей нашего сайта. И для этого нам понадобилось одно окно терминала и всего одна команда.</p>\n<p>Возможно, кто-то скажет, что в NPM есть операторы <code class=\"language-text\">&amp;</code> и <code class=\"language-text\">&amp;&amp;</code>, с помощью которых можно выполнить все тоже самое. Но оператор <code class=\"language-text\">&amp;</code> не работает в Windows <code class=\"language-text\">cmd.exe</code>, а <code class=\"language-text\">npm-run-all -p</code> там отлично работает.</p>\n<h2>Установка и настройка rimraf для очистки каталогов</h2>\n<p>Перед началом компиляции полезно будет очищать каталог <code class=\"language-text\">dist</code> от предыдущих файлов. Для этого будем использовать пакет <code class=\"language-text\">rimraf</code>, который является аналогом UNIX команды <code class=\"language-text\">rm -rf</code>, но работает в любой системе, которая поддерживает NPM. Установим этот пакет:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm i -D rimraf</code></pre></div>\n<p>В файл <code class=\"language-text\">package.json</code> внесем правки:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">  <span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n+   <span class=\"token property\">\"clean\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"rimraf dist\"</span><span class=\"token punctuation\">,</span>\n+   <span class=\"token property\">\"pug\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"pug --pretty src/pages/home/index.pug -o dist\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"watch:pug\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"pug --pretty -w src/pages/home/index.pug -o dist\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"watch:serve\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"browser-sync dist -w\"</span><span class=\"token punctuation\">,</span>\n+   <span class=\"token property\">\"dev\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"npm-run-all clean pug -p watch:*\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"test\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"echo \\\"Error: no test specified\\\" &amp;&amp; exit 1\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n<p>Мы создали скрипт <code class=\"language-text\">\"clean\"</code> для запуска rimraf и указали в скрипте <code class=\"language-text\">\"dev\"</code>, чтобы скрипт <code class=\"language-text\">\"clean\"</code> запускался самым первым. Так как скрипт <code class=\"language-text\">\"clean\"</code> удаляет каталог <code class=\"language-text\">dist</code>, то при параллельном запуске <code class=\"language-text\">pug</code> и <code class=\"language-text\">browser-sync</code> последний выдает ошибку. Поэтому, мы добавили дополнительный скрипт <code class=\"language-text\">\"pug\"</code> без режима наблюдения.</p>\n<p>Закроем все окна терминала и откроем одно новое и сделав корневой каталог проекта рабочим выполним в терминале привычную нам команду:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm run dev</code></pre></div>\n<p><code class=\"language-text\">npm-run-all</code> выполнил сначала скрипт <code class=\"language-text\">\"clean\"</code>, потом скрипт <code class=\"language-text\">\"pug'</code>, а после параллельно запустил два скрипта: <code class=\"language-text\">\"watch:pug\"</code> и <code class=\"language-text\">\"watch:serve\"</code>.</p>\n<h2>Установка и настройка препроцессора node-sass и постпроцессора PostCSS</h2>\n<p>Для написания стилей мы будем использовать препроцессор <a href=\"https://github.com/sass/node-sass#command-line-interface\">Sass</a>. Он позволяет нам использовать переменные, вложенности, миксины, наследование, математические операторы и др.</p>\n<p>При написании стилей мы не хотим задумываться о префиксах, которые необходимы для корректной работы некоторых браузеров, а также, мы уже сегодня хотим использовать современный CSS не думая о его поддержке всеми браузерами. В этом нам поможет PostCSS с плагином <a href=\"https://github.com/csstools/postcss-plugins/tree/main/plugin-packs/postcss-preset-env\">PostCSS Preset Env</a>. Этот плагин преобразует современный CSS в тот CSS, который понятен большинству браузеров, а также расставляет префиксы при необходимости.</p>\n<p>Нам еще понадобится <a href=\"https://github.com/postcss/postcss-cli\">postcss-cli</a>, чтобы запускать PostCSS из командной строки. Для начала установим все необходимые пакеты:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm i -D node-sass postcss postcss-cli postcss-preset-env</code></pre></div>\n<p>Теперь приступим к написанию стилей. Создадим файл <code class=\"language-text\">./src/index.scss</code> и скопируем в него следующее:</p>\n<div class=\"gatsby-highlight\" data-language=\"scss\"><pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token property\"><span class=\"token variable\">$font-size</span></span><span class=\"token punctuation\">:</span> 1rem<span class=\"token punctuation\">;</span>\n<span class=\"token property\"><span class=\"token variable\">$font-color</span></span><span class=\"token punctuation\">:</span> <span class=\"token function\">lch</span><span class=\"token punctuation\">(</span>28 99 35<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token selector\">html </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token variable\">$font-size</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> <span class=\"token variable\">$font-color</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.example </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">user-select</span><span class=\"token punctuation\">:</span> none<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Добавим в файл <code class=\"language-text\">package.json</code> следующий код:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">  <span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n+   <span class=\"token property\">\"clean\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"rimraf dist tmp\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"pug\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"pug --pretty src/pages/home/index.pug -o dist\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"watch:pug\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"pug --pretty -w src/pages/home/index.pug -o dist\"</span><span class=\"token punctuation\">,</span>\n+   <span class=\"token property\">\"sass\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"node-sass src/index.scss -o tmp\"</span><span class=\"token punctuation\">,</span>\n+   <span class=\"token property\">\"watch:sass\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"node-sass -w src/index.scss -o tmp\"</span><span class=\"token punctuation\">,</span>\n+   <span class=\"token property\">\"watch:post\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"postcss -w tmp -d dist -u postcss-preset-env\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"watch:serve\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"browser-sync dist -w\"</span><span class=\"token punctuation\">,</span>\n+   <span class=\"token property\">\"dev\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"npm-run-all clean pug sass -p watch:*\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"test\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"echo \\\"Error: no test specified\\\" &amp;&amp; exit 1\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n<p>Разберемся, что делают эти скрипты.</p>\n<ul>\n<li><code class=\"language-text\">\"clean\": \"rimraf dist tmp\"</code></li>\n</ul>\n<p><code class=\"language-text\">rimraf</code> удаляет каталоги <code class=\"language-text\">dist</code> и <code class=\"language-text\">tmp</code>.</p>\n<ul>\n<li><code class=\"language-text\">\"sass\": \"node-sass src/index.scss -o tmp\"</code></li>\n</ul>\n<p><code class=\"language-text\">node-sass</code> создает каталог <code class=\"language-text\">tmp</code> и однократно выполняет следующее - файл <code class=\"language-text\">src/index.scss</code> и подключенные к нему другие файлы <code class=\"language-text\">.scss</code> компилирует и помещает файл <code class=\"language-text\">tmp/index.css</code>.\nОпция <code class=\"language-text\">-o</code> указывает, что скомпилированные файлы выводятся в каталог, который указывается после этой опции. Здесь этим каталогом является временный каталог <code class=\"language-text\">tmp</code>. Временный он потому, что после компиляции препроцессором файлы должны будут обработаны постпроцессором.</p>\n<ul>\n<li><code class=\"language-text\">\"watch:sass\": \"node-sass -w src/index.scss -o tmp\"</code></li>\n</ul>\n<p><code class=\"language-text\">node-sass</code> следит за файлом <code class=\"language-text\">src/index.scss</code> и каждый раз компилирует его при изменении содержимого, а полученный файл сохраняет в каталоге <code class=\"language-text\">tmp</code> с именем <code class=\"language-text\">index.css</code>.\nСкрипт <code class=\"language-text\">\"watch:sass\"</code> не сильно отличается от скрипта <code class=\"language-text\">\"sass\"</code>. Разница в опции <code class=\"language-text\">-w</code>, которая запускает <code class=\"language-text\">node-sass</code> в режиме наблюдения. Если вызывать скрипт с опцией <code class=\"language-text\">-w</code>, то <code class=\"language-text\">node-sass</code> не сможет создать отсутствующий каталог. Поэтому сначала вызываем скрипт без опции <code class=\"language-text\">-w</code>, а потом с этой опцией.</p>\n<ul>\n<li><code class=\"language-text\">\"watch:post\": \"postcss -w tmp -d dist -u postcss-preset-env\"</code></li>\n</ul>\n<p><code class=\"language-text\">postcss</code> следит за каталогом <code class=\"language-text\">tmp</code> и если содержимое файлов в нем меняется, то файлы прогоняются через указанные плагины и помещаются в каталог <code class=\"language-text\">dist</code> с расширением <code class=\"language-text\">.css</code>\nОпция <code class=\"language-text\">-u</code> указывает, какие плагины должен использовать <code class=\"language-text\">postcss</code> - здесь <code class=\"language-text\">postcss-preset-env</code></p>\n<ul>\n<li><code class=\"language-text\">\"dev\": \"npm-run-all clean sass -p watch:*\"</code></li>\n</ul>\n<p><code class=\"language-text\">npm-run-all</code> запускает последовательно скрипт <code class=\"language-text\">clean</code> потом <code class=\"language-text\">sass</code>, затем запускает параллельно (<code class=\"language-text\">-p</code>) скрипты, у которых имя начинается на <code class=\"language-text\">watch:</code></p>\n<p>Теперь, в терминале запустим команду:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm run dev</code></pre></div>\n<p>Файл <code class=\"language-text\">src/index.scss</code> будет откомпилирован в <code class=\"language-text\">dist/index.css</code>, у которого внутри будет следующее:</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">html</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> 1rem<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> <span class=\"token function\">rgb</span><span class=\"token punctuation\">(</span>146<span class=\"token punctuation\">,</span> 0<span class=\"token punctuation\">,</span> 17<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> <span class=\"token function\">color</span><span class=\"token punctuation\">(</span>display-p3 0.54534 0 0.06183<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.example</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">-webkit-user-select</span><span class=\"token punctuation\">:</span> none<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">-moz-user-select</span><span class=\"token punctuation\">:</span> none<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">user-select</span><span class=\"token punctuation\">:</span> none<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Для того, чтобы наши стили отобразились на странице, добавим в основной шаблон <code class=\"language-text\">src/layouts/base/index.pug</code> ссылку на откомпилированный <code class=\"language-text\">dist/index.css</code></p>\n<div class=\"gatsby-highlight\" data-language=\"pug\"><pre class=\"language-pug\"><code class=\"language-pug\"><span class=\"token punctuation\">-</span>\n  <span class=\"token tag\">let</span> <span class=\"token plain-text\">data = {</span>\n    <span class=\"token tag\">default_description<span class=\"token punctuation\">:</span></span> \"Показан пример общего шаблона Pug для всех страниц\",\n    <span class=\"token tag\">default_title<span class=\"token punctuation\">:</span></span> \"Общий шаблон Pug\"\n  }\n\n<span class=\"token punctuation\">-</span><span class=\"token code\"> <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>default_title<span class=\"token punctuation\">,</span> default_description<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> data</span>\n\n<span class=\"token doctype\">doctype html</span>\n<span class=\"token tag\">html<span class=\"token attributes\"><span class=\"token punctuation\">(</span><span class=\"token attr-name\">lang</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token string\">'ru'</span></span><span class=\"token punctuation\">)</span></span></span>\n  <span class=\"token tag\">head</span>\n    <span class=\"token tag\">meta<span class=\"token attributes\"><span class=\"token punctuation\">(</span><span class=\"token attr-name\">charset</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token string\">'utf-8'</span></span><span class=\"token punctuation\">)</span></span></span>\n    <span class=\"token tag\">meta<span class=\"token attributes\"><span class=\"token punctuation\">(</span><span class=\"token attr-name\">name</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token string\">'viewport'</span> content<span class=\"token operator\">=</span>'width<span class=\"token operator\">=</span>device<span class=\"token operator\">-</span>width</span><span class=\"token punctuation\">,</span> <span class=\"token attr-name\">initial-scale</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token number\">1.0</span>'</span><span class=\"token punctuation\">)</span></span></span>\n<span class=\"token mixin\"><span class=\"token operator\">+</span>   <span class=\"token function\">link</span><span class=\"token punctuation\">(</span>rel<span class=\"token operator\">=</span><span class=\"token string\">'stylesheet'</span> href<span class=\"token operator\">=</span><span class=\"token string\">'index.css'</span><span class=\"token punctuation\">)</span></span>\n\n    <span class=\"token tag\">meta<span class=\"token attributes\"><span class=\"token punctuation\">(</span><span class=\"token attr-name\">name</span><span class=\"token punctuation\">=</span> <span class=\"token attr-value\"><span class=\"token string\">'description'</span> content<span class=\"token operator\">=</span> description <span class=\"token operator\">?</span> description <span class=\"token operator\">:</span> default_description</span><span class=\"token punctuation\">)</span></span></span>\n    <span class=\"token tag\">title</span><span class=\"token punctuation\">=</span><span class=\"token code\"> title <span class=\"token operator\">?</span> title <span class=\"token operator\">:</span> default_title</span>\n\n  <span class=\"token tag\">body</span>\n    <span class=\"token keyword\">block main</span></code></pre></div>\n<p>Сохраним изменения и мы увидим, что страница браузера обновилась со стилевым оформлением заголовка:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 569px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4eddd4f82780cc7b6d7a65a696356cf6/854dc/title-styling.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 16.216216216216214%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAqklEQVQI142I3W6CMABGef9XcosOhjgnW4LxAtoboDKjRYs/VIrmmPQJdpIvOd8JttEX+5+MfbqmfgtpPpeoWUK7yf2a+JvqPaKcfLCdr2iSFSpMqMMFTZKiogV/y1+qacwuzQiuXYfRGqNbzEFzPp7odMvFdJxPxn9nLWNvGe0dd+tx1xuPwfEYBt+ebvRuj4ZAqZpCCAohyfOcsqyQUiKEQAjpfXCO//ICCUPeY8MrV1AAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Стилизация заголовка\"\n        title=\"Стилизация заголовка\"\n        src=\"/static/4eddd4f82780cc7b6d7a65a696356cf6/854dc/title-styling.png\"\n        srcset=\"/static/4eddd4f82780cc7b6d7a65a696356cf6/12f09/title-styling.png 148w,\n/static/4eddd4f82780cc7b6d7a65a696356cf6/e4a3f/title-styling.png 295w,\n/static/4eddd4f82780cc7b6d7a65a696356cf6/854dc/title-styling.png 569w\"\n        sizes=\"(max-width: 569px) 100vw, 569px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>Установка и настройка пакетного конвертера md-pug-to-html</h2>\n<p>Все более распространенным способом написания статей является язык разметки <a href=\"https://daringfireball.net/projects/markdown/\">Markdown</a>. Статья пишется на Markdown и сохраняется в файле с расширением <code class=\"language-text\">.md</code>. Если же в статье нужно поместить рисунки, то удобнее всего создать каталог и поместить в него статью и рисунки. Для каждой статьи создается свой каталог, а каталоги статей объединяются в каталоги по темам.</p>\n<p>Теперь, нам нужен пакетный конвертер, который сможет сканировать эти каталоги, искать файлы Markdown, преобразовать их в Html страницы и помещать в каталог сайта с сохранением исходной структуры каталогов. Также нужно, чтобы изображения к статьям были перемещены в нужные места. При этом, Html страницы должны конвертироваться согласно заданному шаблону Pug.</p>\n<p>Для вышеописанной задачи мне не удалось найти ничего подходящего в репозитории NPM. Наверное, плохо искал. Поэтому, я создал свой пакетный конвертер <a href=\"https://www.npmjs.com/package/md-pug-to-html\">MdPugToHtml</a>.</p>\n<p>Теперь установим этот пакет в нашем проекте</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm i -D md-pug-to-html</code></pre></div>\n<p>Теперь рассмотрим, как пользоваться этим пакетом. Для начала создадим каталог с файлами Markdown. В корневом каталоге проекта создадим каталог <code class=\"language-text\">content</code>, а в нем еще пару каталогов <code class=\"language-text\">article1</code> и <code class=\"language-text\">article2</code>. Каждому такому каталогу нужно давать имена, отражающие название статьи. Они потом будут отображаться в ЧПУ. В каждом таком каталоге будет хранится одна статья и сопутствующие ей файлы изображений если они присутствуют. Сам файл статьи лучше называть везде одинаково - <code class=\"language-text\">index.md</code>.</p>\n<p>Создадим файл <code class=\"language-text\">content/article1/index.md</code> для первой статьи и запишем в него следующее:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">---\ntitle: Статья первая\ndescription: Краткое описание первой статьи\ncreate: 2022-08-10\n---\n\n## Заголовок h2 в первой статье</code></pre></div>\n<p>Создадим файл <code class=\"language-text\">content/article2/index.md</code> для второй статьи и запишем в него следующее:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">---\ntitle: Статья вторая\ndescription: Краткое описание второй статьи\ncreate: 2022-08-11\n---\n\n## Заголовок h2 во второй статье</code></pre></div>\n<p>Блок данных, указанный в начале каждого файла называется Frontmatter, имеет формат YAML/TOML/JSON и отделяется с двух сторон тремя дефисами ---.</p>\n<p>Frontmatter не является стандартом для Markdown и не распознается многими конвертерами. Однако пакет MdPugToHtml умеет распознавать и обрабатывать Frontmatter благодаря пакету <a href=\"https://www.npmjs.com/package/gray-matter\">gray-matter</a>, который встроен в пакет MdPugToHtml в качестве зависимости.</p>\n<p>В файле package.json настроим MdPugToHtml</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">  <span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"clean\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"rimraf dist tmp\"</span><span class=\"token punctuation\">,</span>\n+   <span class=\"token property\">\"md-pug-to-html\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"md-pug-to-html -i=content -o=dist -t=src/pages/article\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"pug\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"pug --pretty src/pages/home/index.pug -o dist\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"watch:pug\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"pug --pretty -w src/pages/home/index.pug -o dist\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"sass\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"node-sass src/index.scss -o tmp\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"watch:sass\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"node-sass -w src/index.scss -o tmp\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"watch:post\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"postcss -w tmp -d dist -u postcss-preset-env\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"watch:serve\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"browser-sync dist -w\"</span><span class=\"token punctuation\">,</span>\n+   <span class=\"token property\">\"dev\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"npm-run-all clean md-pug-to-html pug sass -p watch:*\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"test\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"echo \\\"Error: no test specified\\\" &amp;&amp; exit 1\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n<p>Здесь мы указали с помощью ключа <code class=\"language-text\">-i</code> каталог, где расположены файлы Markdown, с помощью ключ <code class=\"language-text\">-o</code> каталог сборки проекта, а с помощью ключа <code class=\"language-text\">-t</code> каталог, где расположен шаблон Pug для этих страниц. Так как у нас еще нет такого шаблона, то мы его создадим.</p>\n<p>Для этого, в каталоге <code class=\"language-text\">src/pages</code> создадим каталог <code class=\"language-text\">article</code>, в котором создадим файл <code class=\"language-text\">index.pug</code> со следующим содержимым:</p>\n<div class=\"gatsby-highlight\" data-language=\"pug\"><pre class=\"language-pug\"><code class=\"language-pug\"><span class=\"token keyword\">extends ../../layouts/base/index</span>\n\n<span class=\"token keyword\">block main</span>\n  <span class=\"token tag\"><span class=\"token attr-class\">.content</span></span>\n    <span class=\"token tag\"><span class=\"token attr-class\">.article</span></span>\n      <span class=\"token tag\"><span class=\"token attr-class\">.creationDate</span></span><span class=\"token punctuation\">=</span><span class=\"token code\"> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Создано: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>create<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span></span>\n      <span class=\"token keyword\">include from-md.pug</span></code></pre></div>\n<p>Теперь выполним команду:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm run dev</code></pre></div>\n<p>Закроем открывшееся окно браузера и перейдем в каталог <code class=\"language-text\">dist</code>. Здесь мы увидим три новых каталога <code class=\"language-text\">article1</code>, <code class=\"language-text\">article2</code> и <code class=\"language-text\">images</code>. В первых двух расположены страницы HTML, а каталог <code class=\"language-text\">images</code> пуст, в него будут копироваться файлы изображений.</p>\n<p>Если мы перейдем в каталог <code class=\"language-text\">src</code>, то увидим новый каталог <code class=\"language-text\">data</code>, в котором находится файл <code class=\"language-text\">link-list.pug</code>. Этот файл содержит массив объектов с URL адресами, заголовками и кратким описанием для каждой созданной статьи:</p>\n<div class=\"gatsby-highlight\" data-language=\"pug\"><pre class=\"language-pug\"><code class=\"language-pug\"><span class=\"token punctuation\">-</span><span class=\"token code\"> <span class=\"token keyword\">const</span> points <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span><span class=\"token string-property property\">\"pathFile\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"article1/index.html\"</span><span class=\"token punctuation\">,</span><span class=\"token string-property property\">\"title\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"Статья первая\"</span><span class=\"token punctuation\">,</span><span class=\"token string-property property\">\"description\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"Краткое описание первой статьи\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token string-property property\">\"pathFile\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"article2/index.html\"</span><span class=\"token punctuation\">,</span><span class=\"token string-property property\">\"title\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"Статья вторая\"</span><span class=\"token punctuation\">,</span><span class=\"token string-property property\">\"description\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"Краткое описание второй статьи\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span></span></code></pre></div>\n<p>Этот файл мы будем использовать в компоненте, который будет отображать список ссылок на статьи. Для этого в каталоге <code class=\"language-text\">src/components</code> создадим каталог <code class=\"language-text\">list-articles</code>, а в нем создадим файл <code class=\"language-text\">index.pug</code>, в который скопируем код миксина:</p>\n<div class=\"gatsby-highlight\" data-language=\"pug\"><pre class=\"language-pug\"><code class=\"language-pug\"><span class=\"token mixin\"><span class=\"token keyword\">mixin</span> list-<span class=\"token function\">articles</span></span>\n\n  <span class=\"token keyword\">include ../../data/link-list.pug</span>\n  <span class=\"token tag\">ul<span class=\"token attr-class\">.list__box</span></span>\n    <span class=\"token flow-control\"><span class=\"token each\"><span class=\"token keyword\">each</span> point <span class=\"token keyword\">in</span></span> points</span>\n      <span class=\"token tag\">li</span>\n        <span class=\"token tag\">a<span class=\"token attr-class\">.list__item</span><span class=\"token attributes\"><span class=\"token punctuation\">(</span><span class=\"token attr-name\">href</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\">point<span class=\"token punctuation\">.</span>pathFile</span><span class=\"token punctuation\">)</span></span></span><span class=\"token punctuation\">=</span><span class=\"token code\"> point<span class=\"token punctuation\">.</span>title</span>\n        <span class=\"token tag\">p</span><span class=\"token punctuation\">=</span><span class=\"token code\"> point<span class=\"token punctuation\">.</span>description</span></code></pre></div>\n<p>Теперь откроем файл <code class=\"language-text\">src/pages/home/index.pug</code> и подключим в него созданный выше миксин с помощью <code class=\"language-text\">include ../../components/list-articles/index</code>, а затем пропишем его вызов <code class=\"language-text\">+list-articles</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"pug\"><pre class=\"language-pug\"><code class=\"language-pug\"><span class=\"token keyword\">extends ../../layouts/base/index</span>\n<span class=\"token keyword\">include ../../components/button/button</span>\n<span class=\"token keyword\">include ../../components/list-articles/index</span>\n\n<span class=\"token keyword\">block main</span>\n  <span class=\"token tag\">h1<span class=\"token attr-class\">.name</span></span><span class=\"token punctuation\">=</span><span class=\"token code\"> <span class=\"token string\">'Код написан с помощью разметки Pug!'</span></span>\n  <span class=\"token mixin\"><span class=\"token name function\">+button</span></span>\n  <span class=\"token mixin\"><span class=\"token name function\">+list</span><span class=\"token operator\">-</span>articles</span></code></pre></div>\n<p>Перейдем в браузер с нашей страницей, где мы увидим список ссылок на статьи с кратким описанием:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 564px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/386660bb6fac89aa928018f867bfe632/ba4d9/list-articles.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 39.189189189189186%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABJklEQVQoz42QDUvDMBRF+///kShsE50whSmOpRO2bus+um5p2qRZW7f2SCuKA9EGkpcbzrvcF2d+1WH/KgieXphf9/C7fdb3A8LhiOhtit97aPTi5pZlt0/4PGr06m7AstNv+raPw4arGeeoYo5SYaUiDQ/YvWx0Fmtyk2JlRFYz9fshokg0NgjJY00WxRTakMcJ56LArDY409kMd+IiXIGYCGZzD+G6jIXAFYKxcDE2pe1yytMJoyxyZ5GBQe5Syh9A9VWrqtV2avgoY6LFlngVohYBWT2yVJ+jS8W7zS5M/0xYH1lyRO80VlnSg/n+lzzRzf2UF+0Nq/JEvC/wvZKVd8b3zvzW85/RRcJcKexmTX7YY4MAs9mh/Q1pEGLWWwqdtk74AUdIZQR7pyxVAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Список статей\"\n        title=\"Список статей\"\n        src=\"/static/386660bb6fac89aa928018f867bfe632/ba4d9/list-articles.png\"\n        srcset=\"/static/386660bb6fac89aa928018f867bfe632/12f09/list-articles.png 148w,\n/static/386660bb6fac89aa928018f867bfe632/e4a3f/list-articles.png 295w,\n/static/386660bb6fac89aa928018f867bfe632/ba4d9/list-articles.png 564w\"\n        sizes=\"(max-width: 564px) 100vw, 564px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>При нажатии на любую из ссылок мы перейдем на соответствующую страницу со статьей.</p>\n<h2>Установка и настройка сборщика Rollup</h2>\n<p>Для сборки JavaScript файлов будем применять сборщик <a href=\"https://www.npmjs.com/package/rollup\">Rollup</a>. Он будет объединять JavaScript модули в один файл <code class=\"language-text\">index.js</code>. Установим Rollup:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm i -D rollup</code></pre></div>\n<p>Для демонстрации работы сборщика Rollup создадим файл <code class=\"language-text\">src/components/button/button.js</code> и напишем в нем функцию, которая будет изменять текст на кнопке:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">button</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> button <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".button\"</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">let</span> text <span class=\"token operator\">=</span> button<span class=\"token punctuation\">.</span>textContent\n  <span class=\"token keyword\">const</span> message <span class=\"token operator\">=</span> <span class=\"token string\">\"Этот текст изменен JavaScript'ом\"</span>\n\n  button<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    text <span class=\"token operator\">===</span> message <span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>text <span class=\"token operator\">=</span> <span class=\"token string\">\"Жми еще!\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span>text <span class=\"token operator\">=</span> message<span class=\"token punctuation\">)</span>\n    button<span class=\"token punctuation\">.</span>textContent <span class=\"token operator\">=</span> text\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Затем, создадим главный файл скрипта <code class=\"language-text\">src/index.js</code>, в который сделаем импорт вышеуказанного модуля и вызов функции:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> button <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"./components/button/button.js\"</span>\n\n<span class=\"token function\">button</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Теперь в главном шаблоне нашего проекта <code class=\"language-text\">src/layouts/base/index.pug</code> укажем, где будет расположен собранный сборщиком Rollup скрипт <code class=\"language-text\">index.js</code>. Он будет находится в каталоге <code class=\"language-text\">dist</code>. Так как это каталог сборки проекта, и, следовательно он будет корневым каталогом будущего сайта, то мы указываем, просто, имя файла <code class=\"language-text\">script(defer src='index.js')</code>. <code class=\"language-text\">defer</code> мы указали, чтобы скрипт запустился после построения дерева DOM.</p>\n<div class=\"gatsby-highlight\" data-language=\"pug\"><pre class=\"language-pug\"><code class=\"language-pug\"><span class=\"token punctuation\">-</span>\n  <span class=\"token tag\">let</span> <span class=\"token plain-text\">data = {</span>\n    <span class=\"token tag\">default_description<span class=\"token punctuation\">:</span></span> \"Показан пример общего шаблона Pug для всех страниц\",\n    <span class=\"token tag\">default_title<span class=\"token punctuation\">:</span></span> \"Общий шаблон Pug\"\n  }\n\n<span class=\"token punctuation\">-</span><span class=\"token code\"> <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>default_title<span class=\"token punctuation\">,</span> default_description<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> data</span>\n\n<span class=\"token doctype\">doctype html</span>\n<span class=\"token tag\">html<span class=\"token attributes\"><span class=\"token punctuation\">(</span><span class=\"token attr-name\">lang</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token string\">'ru'</span></span><span class=\"token punctuation\">)</span></span></span>\n  <span class=\"token tag\">head</span>\n    <span class=\"token tag\">meta<span class=\"token attributes\"><span class=\"token punctuation\">(</span><span class=\"token attr-name\">charset</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token string\">'utf-8'</span></span><span class=\"token punctuation\">)</span></span></span>\n    <span class=\"token tag\">meta<span class=\"token attributes\"><span class=\"token punctuation\">(</span><span class=\"token attr-name\">name</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token string\">'viewport'</span> content<span class=\"token operator\">=</span>'width<span class=\"token operator\">=</span>device<span class=\"token operator\">-</span>width</span><span class=\"token punctuation\">,</span> <span class=\"token attr-name\">initial-scale</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token number\">1.0</span>'</span><span class=\"token punctuation\">)</span></span></span>\n    <span class=\"token tag\">link<span class=\"token attributes\"><span class=\"token punctuation\">(</span><span class=\"token attr-name\">rel</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token string\">'stylesheet'</span> href<span class=\"token operator\">=</span><span class=\"token string\">'index.css'</span></span><span class=\"token punctuation\">)</span></span></span>\n\n    <span class=\"token tag\">script<span class=\"token attributes\"><span class=\"token punctuation\">(</span>defer <span class=\"token attr-name\">src</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token string\">'index.js'</span></span><span class=\"token punctuation\">)</span></span></span>\n\n    <span class=\"token tag\">meta<span class=\"token attributes\"><span class=\"token punctuation\">(</span><span class=\"token attr-name\">name</span><span class=\"token punctuation\">=</span> <span class=\"token attr-value\"><span class=\"token string\">'description'</span> content<span class=\"token operator\">=</span> description <span class=\"token operator\">?</span> description <span class=\"token operator\">:</span> default_description</span><span class=\"token punctuation\">)</span></span></span>\n    <span class=\"token tag\">title</span><span class=\"token punctuation\">=</span><span class=\"token code\"> title <span class=\"token operator\">?</span> title <span class=\"token operator\">:</span> default_title</span>\n\n  <span class=\"token tag\">body</span>\n    <span class=\"token keyword\">block main</span></code></pre></div>\n<p>Добавим в файл <code class=\"language-text\">package.json</code> скрипт запуска для Rollup:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">  <span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"clean\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"rimraf dist tmp\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"md-pug-to-html\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"md-pug-to-html -i=content -o=dist -t=src/pages/article\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"pug\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"pug --pretty src/pages/home/index.pug -o dist\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"watch:pug\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"pug --pretty -w src/pages/home/index.pug -o dist\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"sass\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"node-sass src/index.scss -o tmp\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"watch:sass\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"node-sass -w src/index.scss -o tmp\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"watch:post\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"postcss -w tmp -d dist -u postcss-preset-env\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"watch:serve\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"browser-sync dist -w\"</span><span class=\"token punctuation\">,</span>\n+   <span class=\"token property\">\"watch:rollup\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"rollup -w -c rollup.config.js\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"dev\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"npm-run-all clean md-pug-to-html pug sass -p watch:*\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"test\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"echo \\\"Error: no test specified\\\" &amp;&amp; exit 1\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n<p>В скрипте <code class=\"language-text\">\"watch:rollup\"</code> параметр <code class=\"language-text\">-w</code> (или<code class=\"language-text\">--watch</code>) сообщает сборщику, что он должен работать в режиме наблюдения, а параметр <code class=\"language-text\">-c</code> (или <code class=\"language-text\">--config</code>) говорит, что есть файл настроек и имя ему <code class=\"language-text\">rollup.config.js</code>.</p>\n<p>Раз указан файл настроек <code class=\"language-text\">rollup.config.js</code>, то создадим его в корне проекта и напишем в нем следующее:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">input</span><span class=\"token operator\">:</span> <span class=\"token string\">\"src/index.js\"</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token literal-property property\">watch</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">include</span><span class=\"token operator\">:</span> <span class=\"token string\">\"./src/**\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">clearScreen</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token literal-property property\">output</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">file</span><span class=\"token operator\">:</span> <span class=\"token string\">\"dist/index.js\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">format</span><span class=\"token operator\">:</span> <span class=\"token string\">\"iife\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Свойство <code class=\"language-text\">input</code> указывает путь к главному скрипту проекта, с которого Rollup начнет собирать все скрипты в один конечный файл-бандл. Адрес этого бандла указан в свойстве <code class=\"language-text\">file</code> объекта <code class=\"language-text\">output</code>. В этом же объекте свойство <code class=\"language-text\">format</code> указывает на формат вывода файла. Здесь указан формат <code class=\"language-text\">'iife'</code>, что превращает код выходного файла в <a href=\"https://benalman.com/news/2010/11/immediately-invoked-function-expression/\">немедленно вызываемую функцию</a> (IIFE). Более подробно о параметре <code class=\"language-text\">format</code> <a href=\"https://rollupjs.org/guide/en/#outputformat\">см. документацию</a>.</p>\n<p>Для режима наблюдения существует множество настроек. Ознакомиться с ними можно в <a href=\"https://rollupjs.org/guide/en/#watch-options\">документации</a>. В нашем же файле свойство <code class=\"language-text\">include</code> ограничивает область наблюдения каталогом <code class=\"language-text\">src</code>, а свойство <code class=\"language-text\">clearScreen</code> запрещает очистку экрана при перезапуске сборщика Rollup.</p>\n<p>Сохраним все изменения и перезапустим проект</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm run dev</code></pre></div>\n<p>Откроется окно браузера, в котором при нажатии на кнопку будет изменяться текст на ней. При первом нажатии текст <code class=\"language-text\">Код написан с помощью разметки Pug</code> будет заменен на <code class=\"language-text\">Этот текст изменен JavaScript'ом</code>, при втором нажатии текст изменится на <code class=\"language-text\">Жми еще!</code>.</p>\n<h2>Оптимизация изображений</h2>\n<p>Одной из главных причин медленной загрузки сайта является большой объем контента с изображениями. Для того, чтобы сайт загружался быстрее нужно максимально оптимизировать эти изображения. Оптимизация изображений подразумевает, как минимум, уменьшение размера файлов при сохранении визуального качества. Чтобы не заниматься этим вручную мы автоматизируем этот процесс. Для автоматического сжатия можно использовать такие инструменты как ImageMagick, <a href=\"https://github.com/jcupitt/libvips\">libvips</a> или <a href=\"https://github.com/imagemin/imagemin-cli\">imagemin</a>. Мы воспользуемся последним.</p>\n<h3>Установка и настройка модуля imagemin</h3>\n<p>Imagemin — популярный модуль сжатия изображений.</p>\n<p>Установим <code class=\"language-text\">imagemin-cli</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm i -D imagemin-cli</code></pre></div>\n<p>Добавим в файл <code class=\"language-text\">package.json</code> следующий код:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"clean\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"rimraf dist tmp\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"md-pug-to-html\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"md-pug-to-html -i=content -o=dist -t=src/pages/article\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"pug\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"pug --pretty src/pages/home/index.pug -o dist\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"watch:pug\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"pug --pretty -w src/pages/home/index.pug -o dist\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"sass\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"node-sass src/index.scss -o tmp\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"watch:sass\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"node-sass -w src/index.scss -o tmp\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"watch:post\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"postcss -w tmp -d dist -u postcss-preset-env\"</span><span class=\"token punctuation\">,</span>\n+   <span class=\"token property\">\"img\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"imagemin src/pages/**/images src/images -o dist/images\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"watch:serve\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"browser-sync dist -w\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"watch:rollup\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"rollup -w -c rollup.config.js\"</span><span class=\"token punctuation\">,</span>\n+   <span class=\"token property\">\"dev\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"npm-run-all clean pug sass img -p watch:*\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"build\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"echo \\\"There's nothing yet, but you can contribute\\\" &amp;&amp; exit 1\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"test\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"echo \\\"Error: no test specified\\\" &amp;&amp; exit 1\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n<p>Скрипт <code class=\"language-text\">\"img\"</code> указывает <code class=\"language-text\">imagemin</code> найти и сжать все изображения в каталогах <code class=\"language-text\">src/pages/**/images</code> и <code class=\"language-text\">src/images</code> и поместить их в <code class=\"language-text\">dist/images</code>. Более подробные настройки можно посмотреть в <a href=\"https://github.com/imagemin/imagemin-cli#usage\">документации</a>.</p>\n<h3>Установка и настройка модуля SVGO</h3>\n<p>Обычно, SVG изображения содержат избыточный код, который любят оставлять редакторы графики. <a href=\"https://github.com/svg/svgo\">SVGO</a> минимизирует файлы SVG удаляя тот самый ненужный код. Существует онлайн инструмент по оптимизации SVG файлов и кода - <a href=\"https://jakearchibald.github.io/svgomg/\">SVGOMG</a>. Также, существуют плагины: для PostCSS - <a href=\"https://www.npmjs.com/package/postcss-svgo\">postcss-svgo</a>; для Rollup - <a href=\"https://github.com/porsager/rollup-plugin-svgo\">rollup-plugin-svgo</a>.</p>\n<p>Мы будем использовать SVGO, который можно <a href=\"https://www.npmjs.com/package/svgo\">установить как CLI</a>:</p>\n<p>npm i -D svgo</p>\n<p>Настроим <code class=\"language-text\">package.json</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n  ...\n  <span class=\"token property\">\"watch:svg\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"svgo -f src/assets/svg -o dist/svg\"</span><span class=\"token punctuation\">,</span>\n  ...\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Флаг <code class=\"language-text\">-f</code> (или <code class=\"language-text\">--folder</code>) указывает, что будут обрабатываться не отдельные файлы, а каталог, что все файлы с расширением <code class=\"language-text\">.svg</code> будут взяты из каталога <code class=\"language-text\">src/assets/svg</code>, оптимизированы и помещены в каталог <code class=\"language-text\">dist/svg</code>, который будет создан при его отсутствии.</p>\n<p>Создадим каталог <code class=\"language-text\">src/assets/svg</code> и поместим туда несколько файлов <code class=\"language-text\">.svg</code>, взять их можно <a href=\"https://fonts.google.com/icons?selected=Material+Icons&#x26;icon.set=Material+Symbols&#x26;icon.query=wh\">здесь</a>. Если мы скачаем значок <code class=\"language-text\">email_black_24dp</code> в виде файла SVG и откроем этот файл в любом текстовом редакторе, то мы увидим следующее:</p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>svg</span> <span class=\"token attr-name\">xmlns</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://www.w3.org/2000/svg<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">height</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>24px<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">viewBox</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0 0 24 24<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>24px<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">fill</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>#000000<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>path</span> <span class=\"token attr-name\">d</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>M0 0h24v24H0V0z<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">fill</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>none<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>path</span> <span class=\"token attr-name\">d</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-.4 4.25l-7.07 4.42c-.32.2-.74.2-1.06 0L4.4 8.25c-.25-.16-.4-.43-.4-.72 0-.67.73-1.07 1.3-.72L12 11l6.7-4.19c.57-.35 1.3.05 1.3.72 0 .29-.15.56-.4.72z<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>svg</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Чтобы значок гибко подстраивался под размер шрифта заменим значения атрибутов <code class=\"language-text\">height</code> и <code class=\"language-text\">width</code> с <code class=\"language-text\">24px</code> на <code class=\"language-text\">1em</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>svg</span> <span class=\"token attr-name\">xmlns</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://www.w3.org/2000/svg<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">height</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>1em<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">viewBox</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0 0 24 24<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>1em<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">fill</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>#000000<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>&lt;path ....</code></pre></div>\n<p>и сохраним этот файл. То же самое проделаем с другими файлами.</p>\n<p>Затем в файл <code class=\"language-text\">src/pages/home/index.pug</code> добавим следующее:</p>\n<div class=\"gatsby-highlight\" data-language=\"pug\"><pre class=\"language-pug\"><code class=\"language-pug\"><span class=\"token keyword\">extends ../../layouts/base/index</span>\n<span class=\"token keyword\">include ../../components/button/button</span>\n<span class=\"token keyword\">include ../../components/list-articles/index</span>\n\n<span class=\"token keyword\">block main</span>\n  <span class=\"token tag\">h1<span class=\"token attr-class\">.name</span></span><span class=\"token punctuation\">=</span><span class=\"token code\"> <span class=\"token string\">'Код написан с помощью разметки Pug!'</span></span>\n  <span class=\"token mixin\"><span class=\"token name function\">+button</span></span>\n  <span class=\"token tag\">p<span class=\"token attr-class\">.text</span></span><span class=\"token punctuation\">=</span><span class=\"token code\"> <span class=\"token string\">'Нажми кнопку'</span></span>\n  <span class=\"token mixin\"><span class=\"token name function\">+list</span><span class=\"token operator\">-</span>articles</span>\n  <span class=\"token tag\">img<span class=\"token attributes\"><span class=\"token punctuation\">(</span><span class=\"token attr-name\">src</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token string\">'images/built-with.png'</span></span><span class=\"token punctuation\">)</span></span></span>\n<span class=\"token mixin\"><span class=\"token operator\">+</span> p<span class=\"token punctuation\">.</span>text<span class=\"token operator\">=</span> <span class=\"token string\">'Если что-то не так, звони по телефону:'</span></span>\n<span class=\"token mixin\"><span class=\"token operator\">+</span> a<span class=\"token punctuation\">.</span>phone<span class=\"token operator\">-</span><span class=\"token function\">link</span><span class=\"token punctuation\">(</span>href<span class=\"token operator\">=</span><span class=\"token string\">'tel:+79189999999'</span><span class=\"token punctuation\">)</span></span>\n<span class=\"token mixin\"><span class=\"token operator\">+</span>   img<span class=\"token punctuation\">.</span>icon<span class=\"token operator\">-</span><span class=\"token function\">phone</span><span class=\"token punctuation\">(</span>src<span class=\"token operator\">=</span><span class=\"token string\">'svg/phone_black_24dp.svg'</span><span class=\"token punctuation\">)</span></span>\n<span class=\"token mixin\"><span class=\"token operator\">+</span>   <span class=\"token punctuation\">.</span>phone<span class=\"token operator\">-</span>number<span class=\"token operator\">=</span><span class=\"token string\">'+79189999999'</span></span></code></pre></div>\n<p>В конец уже существующего файла <code class=\"language-text\">src/index.scss</code> добавим следующие стили:</p>\n<div class=\"gatsby-highlight\" data-language=\"scss\"><pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token selector\">.phone-link </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">display</span><span class=\"token punctuation\">:</span> flex<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">text-decoration</span><span class=\"token punctuation\">:</span> none<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> <span class=\"token variable\">$font-color</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.icon-phone </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> 2.5 <span class=\"token operator\">*</span> <span class=\"token variable\">$font-size</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">height</span><span class=\"token punctuation\">:</span> 2.5 <span class=\"token operator\">*</span> <span class=\"token variable\">$font-size</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.phone-number </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> 2.4 <span class=\"token operator\">*</span> <span class=\"token variable\">$font-size</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Запустим сборку:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm run dev</code></pre></div>\n<p>В окне браузера в самом низу мы увидим следующее:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 282px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8314b1b727e2492c2db6b59fd76b8ef1/cd13f/phone-svg-image.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.054054054054056%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABNUlEQVQY06WQ2U7CYBCF+/T6BPoCXiGauIQYE7UuuEQiRIhCEStt2aHt34UulPoZfmLw3pOczHZmMjPK9K2N+OwivgycjonfGyB0A1e3EJ8GQjcJ+kMm9SazZkdqPaOP6FrYzQ9G1QbTRgvPHLCCkswcoqlN4grmE5vE82UczVxi2yUcT4kdF783JBiMZS12BLErCIcTvK6Fb/ZlrxwYL1K+2eA7z/kPlO2tLelkUbQ+rdZAL10wemngfHwxrr7SKz9jqg+Yl3dY6j3W7RPWzYqPGJdljKsy3fNr+QpFVVV2dncxtDZC0wkHIynsHJ0xrNRpH5ZoFU6k1QrHaMW1/0tt/xSteMr73gGj2htKnudUKhXC+VxuuphH5FlGliSkQUjiBaR+QJakLNMFy5X9y3STz5c5P/D5unBtoopAAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"SVG значок телефона\"\n        title=\"SVG значок телефона\"\n        src=\"/static/8314b1b727e2492c2db6b59fd76b8ef1/cd13f/phone-svg-image.png\"\n        srcset=\"/static/8314b1b727e2492c2db6b59fd76b8ef1/12f09/phone-svg-image.png 148w,\n/static/8314b1b727e2492c2db6b59fd76b8ef1/cd13f/phone-svg-image.png 282w\"\n        sizes=\"(max-width: 282px) 100vw, 282px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>Установка и настройка генератора спрайтов svg-sprite-generator</h2>\n<p><a href=\"https://www.npmjs.com/package/svg-sprite-generator\">svg-sprite-generator</a> - генератор SVG-спрайтов, который из отдельных файлов SVG создает один файл-спрайт.</p>\n<p>Установим пакет:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm i -D svg-sprite-generator</code></pre></div>\n<p>Напишем настройки в <code class=\"language-text\">package.json</code></p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">  <span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"clean\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"rimraf dist tmp\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"pug\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"pug --pretty src/pages/home/index.pug -o dist\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"watch:pug\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"pug -w --pretty src/pages/home/index.pug -o dist\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"sass\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"node-sass src/pages/home/index.scss -o tmp\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"watch:sass\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"node-sass -w src/pages/home/index.scss -o tmp\"</span><span class=\"token punctuation\">,</span>\n+   <span class=\"token property\">\"watch:svg\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"svgo -f src/assets/svg -o dist/svg &amp;&amp; svg-sprite-generate -d dist/svg -o dist/svg/sprite.svg\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"watch:post\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"postcss -w tmp/index.css -d dist -u postcss-preset-env\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"img\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"imagemin src/pages/**/images/* src/images/* -o dist/images\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"watch:serve\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"browser-sync dist -w\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"watch:rollup\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"rollup --watch -c rollup.config.js\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"dev\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"npm-run-all clean pug sass img -p watch:*\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"build\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"echo \\\"There's nothing yet, but you can contribute\\\" &amp;&amp; exit 1\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"test\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"echo \\\"Error: no test specified\\\" &amp;&amp; exit 1\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n<p>С помощью цепочки из операторов <code class=\"language-text\">&amp;&amp;</code> можно последовательно запускать различные скрипты. Так в скрипте <code class=\"language-text\">\"watch:svg\"</code> мы добавим через <code class=\"language-text\">&amp;&amp;</code> другой скрипт. Это значит, что после успешного выполнения кода <code class=\"language-text\">-f src/assets/svg -o dist/svg</code> будет выполнен код <code class=\"language-text\">svg-sprite-generate -d dist/svg -o dist/svg/sprite.svg</code>, который означает, что все файлы с расширением <code class=\"language-text\">.svg</code> будут взяты из каталога <code class=\"language-text\">dist/svg</code>, объединены в спрайт <code class=\"language-text\">sprite.svg</code> и этот спрайт будет помещен в этот же каталог.</p>\n<p>Выполним сборку всего проекта:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm run dev</code></pre></div>\n<p>Мы обнаружим в каталоге <code class=\"language-text\">dist/svg/</code> новый файл <code class=\"language-text\">sprite.svg</code>. Спрайт внутри выглядит, примерно, так:</p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token prolog\">&lt;?xml version=\"1.0\" encoding=\"utf-8\"?></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>svg</span> <span class=\"token attr-name\">xmlns</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://www.w3.org/2000/svg<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>symbol</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>email_black_24dp<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>path</span> <span class=\"token attr-name\">d</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>M0 0h24v24H0V0z<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">fill</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>none<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>path</span> <span class=\"token attr-name\">d</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2...<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>symbol</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>symbol</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>phone_black_24dp<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>path</span> <span class=\"token attr-name\">d</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>M0 0h24v24H0V0z<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">fill</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>none<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>path</span> <span class=\"token attr-name\">d</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>m19.23 15.26-2.54-.29a1.99 1.99 0 0 0-1.64.57l-1.84 1.84a15.045 15.045 0 0 1-6.59-...<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>symbol</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>symbol</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>whatsapp_black_24dp<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>path</span> <span class=\"token attr-name\">d</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>M0 0h24v24H0z<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>g</span> <span class=\"token attr-name\">fill</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>none<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>path</span> <span class=\"token attr-name\">d</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>M0 0h24v24H0z<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>g</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>path</span> <span class=\"token attr-name\">d</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>M19.05 4.91A9.816 9.816 0 0 0 12.04 2c-5.46 0-9.91 4.45-9.91 9...<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>symbol</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>svg</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Здесь в один спрайт упаковано три файла SVG. Код каждого отдельного файла SVG заключен между тегами <code class=\"language-text\">&lt;symbol></code>, а это значит, что значки не будут отображаться если мы попробуем вызвать отдельный элемент спрайта вот так: <code class=\"language-text\">&lt;img src=\"svg/sprite.svg#email_black_24dp\"/></code>. Отобразить нужный значок можно, если его вызвать с помощью команды <code class=\"language-text\">&lt;use></code> по уникальному идентификатору. Соответственно, тэг <code class=\"language-text\">&lt;use></code> должен быть обернут тегом <code class=\"language-text\">&lt;svg></code>. Отобразим какой-нибудь значок из спрайта, для этого добавим в конец файла <code class=\"language-text\">src/pages/home/index.pug</code> следующий код:</p>\n<div class=\"gatsby-highlight\" data-language=\"pug\"><pre class=\"language-pug\"><code class=\"language-pug\">  <span class=\"token tag\">p<span class=\"token attr-class\">.text</span></span><span class=\"token punctuation\">=</span><span class=\"token code\"> <span class=\"token string\">'или пиши на почту:'</span></span>\n  <span class=\"token tag\">a<span class=\"token attr-class\">.email-link</span><span class=\"token attributes\"><span class=\"token punctuation\">(</span><span class=\"token attr-name\">href</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token string\">'mailto:info@jinv.ru'</span> title<span class=\"token operator\">=</span><span class=\"token string\">'Написать письмо'</span></span><span class=\"token punctuation\">)</span></span></span>\n    <span class=\"token tag\">svg<span class=\"token attr-class\">.icon</span><span class=\"token attributes\"><span class=\"token punctuation\">(</span><span class=\"token attr-name\">role</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token string\">'img'</span></span><span class=\"token punctuation\">)</span></span></span>\n      <span class=\"token tag\">use<span class=\"token attributes\"><span class=\"token punctuation\">(</span><span class=\"token attr-name\">href</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token string\">'svg/sprite.svg#email_black_24dp'</span></span><span class=\"token punctuation\">)</span></span></span>\n    <span class=\"token tag\"><span class=\"token attr-class\">.email-address</span></span><span class=\"token punctuation\">=</span><span class=\"token code\"><span class=\"token string\">'info@jinv.ru'</span></span></code></pre></div>\n<p>Стилизуем данный код в файле <code class=\"language-text\">src/index.scss</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"scss\"><pre class=\"language-scss\"><code class=\"language-scss\"><span class=\"token selector\">.email-link </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">display</span><span class=\"token punctuation\">:</span> flex<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">text-decoration</span><span class=\"token punctuation\">:</span> none<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> <span class=\"token variable\">$font-color</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token selector\"><span class=\"token parent important\">&amp;</span>:hover </span><span class=\"token punctuation\">{</span>\n    <span class=\"token property\">text-decoration</span><span class=\"token punctuation\">:</span> underline<span class=\"token punctuation\">;</span>\n    <span class=\"token property\">background-color</span><span class=\"token punctuation\">:</span> bisque<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.icon </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> 2.5 <span class=\"token operator\">*</span> <span class=\"token variable\">$font-size</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">height</span><span class=\"token punctuation\">:</span> 2.5 <span class=\"token operator\">*</span> <span class=\"token variable\">$font-size</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.email-address </span><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> 2 <span class=\"token operator\">*</span> <span class=\"token variable\">$font-size</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Запустим сборку:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm run dev</code></pre></div>\n<p>В окне браузера в самом низу мы увидим следующее:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 282px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8314b1b727e2492c2db6b59fd76b8ef1/cd13f/phone-svg-image.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.054054054054056%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABNUlEQVQY06WQ2U7CYBCF+/T6BPoCXiGauIQYE7UuuEQiRIhCEStt2aHt34UulPoZfmLw3pOczHZmMjPK9K2N+OwivgycjonfGyB0A1e3EJ8GQjcJ+kMm9SazZkdqPaOP6FrYzQ9G1QbTRgvPHLCCkswcoqlN4grmE5vE82UczVxi2yUcT4kdF783JBiMZS12BLErCIcTvK6Fb/ZlrxwYL1K+2eA7z/kPlO2tLelkUbQ+rdZAL10wemngfHwxrr7SKz9jqg+Yl3dY6j3W7RPWzYqPGJdljKsy3fNr+QpFVVV2dncxtDZC0wkHIynsHJ0xrNRpH5ZoFU6k1QrHaMW1/0tt/xSteMr73gGj2htKnudUKhXC+VxuuphH5FlGliSkQUjiBaR+QJakLNMFy5X9y3STz5c5P/D5unBtoopAAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"SVG значок email\"\n        title=\"SVG значок email\"\n        src=\"/static/8314b1b727e2492c2db6b59fd76b8ef1/cd13f/phone-svg-image.png\"\n        srcset=\"/static/8314b1b727e2492c2db6b59fd76b8ef1/12f09/phone-svg-image.png 148w,\n/static/8314b1b727e2492c2db6b59fd76b8ef1/cd13f/phone-svg-image.png 282w\"\n        sizes=\"(max-width: 282px) 100vw, 282px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>","frontmatter":{"title":"Настройка среды разработки из NPM модулей и создание статического сайта","date":"09 August 2022","update":null,"description":"Установка и настройка сборки из NPM модулей, которая позволит создать статический сайт используя шаблонизатор Pug, препроцессор Sass, язык JavaScript и разметку Markdown"}}},"pageContext":{"slug":"/Sozdanie-saytov/Nastrojka-NPM-dlya-staticheskogo-sajta/","previous":{"fields":{"slug":"/Express/Shablonizator-Pug/"},"frontmatter":{"title":"Шаблонизатор PugJS"}},"next":null}},"staticQueryHashes":["3913406117","63159454"]}