{"componentChunkName":"component---src-templates-blog-post-js","path":"/Express/Shablonizator-Pug/","result":{"data":{"site":{"siteMetadata":{"title":"jinv.ru"}},"markdownRemark":{"id":"277a5dcf-edb1-5a62-8089-a160d00975f0","excerpt":"В приложениях Express для визуализации интерфейса, обычно, используют не стандартные файлы html, а специальные представления (шаблоны), из которых с помощью…","html":"<p>В приложениях Express для визуализации интерфейса, обычно, используют не стандартные файлы html, а специальные представления (шаблоны), из которых с помощью <strong>движка представлений</strong> (view engine) создаются html-файлы. Движок представлений еще называют <strong>движком шаблонов</strong> (template engine) или <strong>шаблонизатором</strong>, которых для Express написано довольно много: Handlebars, Dust, Pug, Jade, Nunjucks, EJS, и др. Все они функционально похожи и отличаются в небольших деталях. Выбор того или иного движка зависит от личных предпочтений.</p>\n<p>Механизм шаблонов позволяет использовать в приложении статические файлы шаблонов (например, написанные на Pug), вместо которых затем вставляется какое-то динамическое содержимое с помощью кода javascript. Во время выполнения переменные в файле шаблона заменяются фактическими значениями, которые могут быть предоставлены вашим сервером. Шаблон преобразуется в статический HTML-файл, который отправляется клиенту. Этот подход упрощает проектирование HTML-страницы и позволяет отображать переменные на странице без необходимости выполнения вызова API от клиента.</p>\n<p><a href=\"https://pugjs.org/api/getting-started.html\">Pug</a> - это шаблонизатор и html-препроцессор, написанный на javascript для node.js. Pug имеет целый ряд преимуществ по сравнению с обычным HTML.</p>\n<p>Установим пакет шаблонизатора Pug из <a href=\"https://www.npmjs.com/\">npm</a>:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ npm install pug</code></pre></div>\n<p>Создададим файл app.js со следующим кодом:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> express <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"express\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token function\">express</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"view engine\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"pug\"</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// Указывает, что в качестве шаблонизатора используется Pug</span>\n\n<span class=\"token comment\">/* Нижеприведенную строку кода можно не писать, так как каталог /views устанавливается по умолчанию. */</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"views\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"./views\"</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// Указывает на каталог, в котором находятся файлы шаблонов.</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/contact\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  res<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"contact\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">//\"contact\" - это имя файла шаблона в каталоге views</span>\n    title<span class=\"token operator\">:</span> <span class=\"token string\">\"Мои номера телефонов\"</span><span class=\"token punctuation\">,</span>\n    phonesVisible<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    phones<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"+1234567890\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"+9876543210\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    email<span class=\"token operator\">:</span> <span class=\"token string\">\"tuk@tuk.com\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  res<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Главная страница\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span><span class=\"token number\">3000</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Затем добавим в папку <code class=\"language-text\">views</code> файл <code class=\"language-text\">contact.pug</code> со следующим кодом:</p>\n<div class=\"gatsby-highlight\" data-language=\"pug\"><pre class=\"language-pug\"><code class=\"language-pug\"><span class=\"token markup\"><span class=\"token doctype\">&lt;!DOCTYPE html></span></span>\n<span class=\"token markup\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span></span>\n<span class=\"token markup\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span></span>\n    <span class=\"token markup\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>#{title}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span> <span class=\"token comment\">&lt;!-- Для данных внутри html-элементов применяются теги `#{выражение}` --></span></span>\n    <span class=\"token markup\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">'</span>viewport<span class=\"token punctuation\">'</span></span><span class=\"token attr-name\">,</span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>initial-scale=1.0, width=device-width<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></span>\n    <span class=\"token markup\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>utf-8<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></span>\n<span class=\"token markup\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span></span>\n<span class=\"token markup\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span></span>\n\n    <span class=\"token markup\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">></span></span>#{title} в фирме<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span></span>\n\n    <span class=\"token flow-control\"><span class=\"token branch keyword\">if</span> phonesVisible</span>\n        <span class=\"token markup\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h3</span><span class=\"token punctuation\">></span></span>Номера телефонов<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h3</span><span class=\"token punctuation\">></span></span></span>\n        <span class=\"token markup\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span><span class=\"token punctuation\">></span></span></span>\n            <span class=\"token flow-control\"><span class=\"token each\"><span class=\"token keyword\">each</span> phone <span class=\"token keyword\">in</span></span> phones</span>\n                <span class=\"token markup\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span><span class=\"token punctuation\">></span></span>#{phone}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">></span></span></span>\n        <span class=\"token markup\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">></span></span></span>\n    <span class=\"token flow-control\"><span class=\"token branch keyword\">else</span></span>\n        <span class=\"token markup\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h3</span><span class=\"token punctuation\">></span></span>Телефоны не указаны<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h3</span><span class=\"token punctuation\">></span></span></span>\n    <span class=\"token markup\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>Электронный адрес: #{email}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span></span>\n<span class=\"token markup\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span></span>\n<span class=\"token markup\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span></span></code></pre></div>\n<p>В коде выше выражение <code class=\"language-text\">each phone in phones</code> представляет собой цикл. В нем <code class=\"language-text\">phone</code> - переменная, а <code class=\"language-text\">phones</code> - массив. Значения из массива <code class=\"language-text\">phones</code> с помощью перебора подставляются в переменную <code class=\"language-text\">phone</code> и выводятся на страницу в виде списка. Также в вышеприведенном коде есть условный оператор <code class=\"language-text\">if...else</code>, который работает также, как и условный оператор в других языках программирования.</p>\n<p>Если теперь запустить проект и обратиться по адресу <code class=\"language-text\">http://localhost:3000/contact</code> приложение сгенерирует веб-страницу:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 500px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/47d9857e1010b8e9ca703dad53fd6449/0b533/screen.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 61.48648648648649%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAACEklEQVQoz5WTzW7aUBCF/TYllC6yj/oEfYIsuqjaAnmNSOmTBAgLHqBdtEpQW4jBUIzBgA3GhtjmN2D+4Z7OdRCtVKVtRjq650rjb+ZqxsJZNLpNxOOIXV6y5NUV4rEY9ndfyWQSiUQCL09OEAwEEAoG8fzoyBf3L0ih42P2KvgMp6HAWkilUlitVmw8HmM0GmEwGGAymfi+3+/D8zxstzt8uLhAJBxGNBI5iJrBGZ1v3r3HefgtO399CqEgSWw4HIKAzDAMH+Q4NprNJjRdJ+/Atm2/EIf/HsvlEvP5HDlRZPZgiHy5zAT+0WPB8LRQymUInz99xM2XaxQLRaiVCvJiHkVJwm0mC13T0FBrqCgVPyf7PQPxVsQPym01W/iaTuPmOo1cNgutoUOhPEGRSzBaBpqaDssy0ahrdG8ROAez3YbVNilZ8wsUpQIUuQy1qqJrdSDlcsh8y1CuCMu0oFBDgkj0ntvDgAZwP74n78I02uTHeGqoahVCsVBAh+i8Ew7mXWn1Buw7G4wx7Ha7f2qz2fjAapWApmn6F4cAdXpKo1aHYzsPQ2G/xnLw7M9RcegBqOs64xXoyYyviEviz+WA/9V2u2V7IBPkUgk9x2UdswOXOrO7d+j3enCpY5OGY3dtDGnH/hb77lmtVoOgqipbr9eYTqds5s3gTT3wky8sX+TZ7MHT3/SoFouFT5RlefcTtMtbiAqEb4kAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"screen\"\n        title=\"screen\"\n        src=\"/static/47d9857e1010b8e9ca703dad53fd6449/0b533/screen.png\"\n        srcset=\"/static/47d9857e1010b8e9ca703dad53fd6449/12f09/screen.png 148w,\n/static/47d9857e1010b8e9ca703dad53fd6449/e4a3f/screen.png 295w,\n/static/47d9857e1010b8e9ca703dad53fd6449/0b533/screen.png 500w\"\n        sizes=\"(max-width: 500px) 100vw, 500px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Pug позволяет писать с помощью сокращенной html-разметки. Перепишем код в файле <code class=\"language-text\">contact.pug</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"pug\"><pre class=\"language-pug\"><code class=\"language-pug\"><span class=\"token doctype\">doctype html</span>\n<span class=\"token tag\">html</span>\n\t<span class=\"token tag\">head</span>\n\t\t<span class=\"token tag\">title</span><span class=\"token punctuation\">=</span><span class=\"token code\">title</span>\n\t\t<span class=\"token tag\">meta<span class=\"token attributes\"><span class=\"token punctuation\">(</span><span class=\"token attr-name\">charset</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token string\">'utf-8'</span></span><span class=\"token punctuation\">)</span></span></span>\n\t\t<span class=\"token tag\">meta<span class=\"token attributes\"><span class=\"token punctuation\">(</span><span class=\"token attr-name\">name</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token string\">'viewport'</span></span><span class=\"token punctuation\">,</span> <span class=\"token attr-name\">content</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\">\"initial<span class=\"token operator\">-</span>scale<span class=\"token operator\">=</span><span class=\"token number\">1.0</span></span><span class=\"token punctuation\">,</span> <span class=\"token attr-name\">width</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\">device<span class=\"token operator\">-</span>width\"</span><span class=\"token punctuation\">)</span></span></span>\n\n\t<span class=\"token tag\">body</span>\n\n\t\t<span class=\"token tag\">h1</span> <span class=\"token plain-text\">#{title} в фирме</span>\n\n\t\t<span class=\"token flow-control\"><span class=\"token branch keyword\">if</span> phonesVisible</span>\n\t\t\t<span class=\"token tag\">h3</span> <span class=\"token plain-text\">Номера телефонов</span>\n\t\t\t<span class=\"token tag\">ul</span>\n\t\t\t\t<span class=\"token flow-control\"><span class=\"token each\"><span class=\"token keyword\">each</span> phone <span class=\"token keyword\">in</span></span> phones</span>\n\t\t\t\t\t<span class=\"token tag\">li</span><span class=\"token punctuation\">=</span><span class=\"token code\">phone</span>\n\n\t\t<span class=\"token flow-control\"><span class=\"token branch keyword\">else</span></span>\n\t\t\t<span class=\"token tag\">h3</span> <span class=\"token plain-text\">Телефоны не указаны</span>\n\t\t<span class=\"token tag\">p</span> <span class=\"token plain-text\">Электронный адрес: #{email}</span></code></pre></div>","frontmatter":{"title":"Шаблонизатор PugJS","date":"01 June 2020","description":"Шаблонизатор Pug позволяет использовать сокращенную html-разметку, а также переменные, циклы, условные операторы. Это дает возможность подставлять динамические данные"}}},"pageContext":{"slug":"/Express/Shablonizator-Pug/","previous":{"fields":{"slug":"/Tests/Chai/"},"frontmatter":{"title":"Тестирование кода с помощью библиотеки Chai"}},"next":null}}}